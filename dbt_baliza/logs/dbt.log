[0m15:57:03.499775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caef25cacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caef3b0cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caef12379d0>]}


============================== 15:57:03.552758 | 3f01aa82-a7ca-4c09-a8a9-862e4b755811 ==============================
[0m15:57:03.552758 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:57:03.553732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/frank/workspace/baliza/dbt_baliza/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:57:03.641254 [info ] [MainThread]: dbt version: 1.10.4
[0m15:57:03.642001 [info ] [MainThread]: python version: 3.13.5
[0m15:57:03.642466 [info ] [MainThread]: python path: /home/frank/workspace/baliza/.venv/bin/python3
[0m15:57:03.642923 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m15:57:03.829807 [info ] [MainThread]: Using profiles dir at .
[0m15:57:03.830484 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m15:57:03.831157 [info ] [MainThread]: Using dbt_project.yml file at /home/frank/workspace/baliza/dbt_baliza/dbt_project.yml
[0m15:57:03.835682 [info ] [MainThread]: adapter type: duckdb
[0m15:57:03.836572 [info ] [MainThread]: adapter version: 1.9.4
[0m15:57:04.027329 [info ] [MainThread]: Configuration:
[0m15:57:04.027989 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:57:04.028332 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:57:04.028807 [info ] [MainThread]: Required dependencies:
[0m15:57:04.029266 [debug] [MainThread]: Executing "git --help"
[0m15:57:04.032180 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:57:04.032626 [debug] [MainThread]: STDERR: "b''"
[0m15:57:04.032914 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:57:04.033183 [info ] [MainThread]: Connection:
[0m15:57:04.033481 [info ] [MainThread]:   database: baliza
[0m15:57:04.033756 [info ] [MainThread]:   schema: main
[0m15:57:04.033999 [info ] [MainThread]:   path: ../state/baliza.duckdb
[0m15:57:04.034234 [info ] [MainThread]:   config_options: None
[0m15:57:04.034462 [info ] [MainThread]:   extensions: ['httpfs', 'json', 'spatial']
[0m15:57:04.034694 [info ] [MainThread]:   settings: {'enable_external_access': True, 'max_memory': '2GB', 'threads': 4}
[0m15:57:04.035007 [info ] [MainThread]:   external_root: .
[0m15:57:04.035238 [info ] [MainThread]:   use_credential_provider: None
[0m15:57:04.035466 [info ] [MainThread]:   attach: None
[0m15:57:04.035686 [info ] [MainThread]:   filesystems: None
[0m15:57:04.035924 [info ] [MainThread]:   remote: None
[0m15:57:04.036138 [info ] [MainThread]:   plugins: None
[0m15:57:04.036354 [info ] [MainThread]:   disable_transactions: False
[0m15:57:04.036863 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:57:04.107729 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m15:57:04.161891 [debug] [MainThread]: Using duckdb connection "debug"
[0m15:57:04.164204 [debug] [MainThread]: On debug: select 1 as id
[0m15:57:04.166569 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:15.209361 [debug] [MainThread]: DuckDB adapter: Error running SQL: select 1 as id
[0m15:58:15.210167 [debug] [MainThread]: DuckDB adapter: Rolling back transaction.
[0m15:58:15.210813 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:58:15.211495 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:58:15.211818 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  Invalid Input Error: Cannot change enable_external_access setting while database is running

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:58:15.212976 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 71.77538, "process_in_blocks": "37416", "process_kernel_time": 2.019195, "process_mem_max_rss": "412488", "process_out_blocks": "358344", "process_user_time": 76.00915}
[0m15:58:15.213528 [debug] [MainThread]: Command `dbt debug` failed at 15:58:15.213426 after 71.78 seconds
[0m15:58:15.213914 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:58:15.214347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caef1082520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caef10770b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7caef11ce140>]}
[0m15:58:15.214903 [debug] [MainThread]: Flushing usage events
[0m15:58:16.483832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:58:37.118684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b880d7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b86d6fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b86d6f9d0>]}


============================== 15:58:37.121687 | 8534cdea-a6a3-4fb9-b839-779a3b24f30a ==============================
[0m15:58:37.121687 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:58:37.122256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/frank/workspace/baliza/dbt_baliza/logs', 'version_check': 'True', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug --profiles-dir .', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:58:37.128871 [info ] [MainThread]: dbt version: 1.10.4
[0m15:58:37.129311 [info ] [MainThread]: python version: 3.13.5
[0m15:58:37.129584 [info ] [MainThread]: python path: /home/frank/workspace/baliza/.venv/bin/python3
[0m15:58:37.129832 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m15:58:37.216989 [info ] [MainThread]: Using profiles dir at .
[0m15:58:37.217555 [info ] [MainThread]: Using profiles.yml file at ./profiles.yml
[0m15:58:37.217848 [info ] [MainThread]: Using dbt_project.yml file at /home/frank/workspace/baliza/dbt_baliza/dbt_project.yml
[0m15:58:37.219082 [info ] [MainThread]: adapter type: duckdb
[0m15:58:37.219507 [info ] [MainThread]: adapter version: 1.9.4
[0m15:58:37.298333 [info ] [MainThread]: Configuration:
[0m15:58:37.298850 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:58:37.299250 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:58:37.299546 [info ] [MainThread]: Required dependencies:
[0m15:58:37.299850 [debug] [MainThread]: Executing "git --help"
[0m15:58:37.301989 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:58:37.302393 [debug] [MainThread]: STDERR: "b''"
[0m15:58:37.302649 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:58:37.303019 [info ] [MainThread]: Connection:
[0m15:58:37.303310 [info ] [MainThread]:   database: baliza_dbt
[0m15:58:37.303554 [info ] [MainThread]:   schema: main
[0m15:58:37.303788 [info ] [MainThread]:   path: ../state/baliza_dbt.duckdb
[0m15:58:37.304025 [info ] [MainThread]:   config_options: None
[0m15:58:37.304270 [info ] [MainThread]:   extensions: ['httpfs', 'json', 'spatial']
[0m15:58:37.304518 [info ] [MainThread]:   settings: {'max_memory': '2GB', 'threads': 4}
[0m15:58:37.304759 [info ] [MainThread]:   external_root: .
[0m15:58:37.304987 [info ] [MainThread]:   use_credential_provider: None
[0m15:58:37.305217 [info ] [MainThread]:   attach: None
[0m15:58:37.305442 [info ] [MainThread]:   filesystems: None
[0m15:58:37.305665 [info ] [MainThread]:   remote: None
[0m15:58:37.305912 [info ] [MainThread]:   plugins: None
[0m15:58:37.306143 [info ] [MainThread]:   disable_transactions: False
[0m15:58:37.306555 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:58:37.349139 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m15:58:37.371942 [debug] [MainThread]: Using duckdb connection "debug"
[0m15:58:37.372555 [debug] [MainThread]: On debug: select 1 as id
[0m15:58:37.372890 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:37.550637 [debug] [MainThread]: SQL status: OK in 0.178 seconds
[0m15:58:37.551708 [debug] [MainThread]: On debug: Close
[0m15:58:37.552147 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:58:37.552510 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:58:37.553145 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.47366503, "process_in_blocks": "0", "process_kernel_time": 0.289628, "process_mem_max_rss": "169884", "process_out_blocks": "48", "process_user_time": 1.955932}
[0m15:58:37.553568 [debug] [MainThread]: Command `dbt debug` succeeded at 15:58:37.553495 after 0.47 seconds
[0m15:58:37.553841 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:58:37.554146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b82dfdba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b82c68b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b86c39590>]}
[0m15:58:37.554486 [debug] [MainThread]: Flushing usage events
[0m15:58:38.220454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:42.427966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a40210cba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a401fd5fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a401fd5f9d0>]}


============================== 15:59:42.431348 | 23d974a5-89ec-4382-b1fb-f29a3da6e14e ==============================
[0m15:59:42.431348 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:59:42.431903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/frank/workspace/baliza/dbt_baliza/logs', 'profiles_dir': '.', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --profiles-dir . --select stg_contratos', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:59:42.619992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23d974a5-89ec-4382-b1fb-f29a3da6e14e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4020a4b820>]}
[0m15:59:42.671340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23d974a5-89ec-4382-b1fb-f29a3da6e14e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a401ffed370>]}
[0m15:59:42.672735 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:59:42.720442 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:59:42.721328 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:59:42.721717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '23d974a5-89ec-4382-b1fb-f29a3da6e14e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a401fe1d450>]}
[0m15:59:43.737097 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.baliza
- snapshots.baliza
[0m15:59:43.744597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23d974a5-89ec-4382-b1fb-f29a3da6e14e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a401bb94050>]}
[0m15:59:43.807745 [debug] [MainThread]: Wrote artifact WritableManifest to /home/frank/workspace/baliza/dbt_baliza/target/manifest.json
[0m15:59:43.809946 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/frank/workspace/baliza/dbt_baliza/target/semantic_manifest.json
[0m15:59:43.840627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23d974a5-89ec-4382-b1fb-f29a3da6e14e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a401b967770>]}
[0m15:59:43.841402 [info ] [MainThread]: Found 4 models, 14 data tests, 2 sources, 432 macros
[0m15:59:43.841921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23d974a5-89ec-4382-b1fb-f29a3da6e14e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a401a9cfc70>]}
[0m15:59:43.843872 [info ] [MainThread]: 
[0m15:59:43.844442 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:59:43.844782 [info ] [MainThread]: 
[0m15:59:43.845284 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:59:43.846437 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_baliza_dbt'
[0m15:59:43.879972 [debug] [ThreadPool]: Using duckdb connection "list_baliza_dbt"
[0m15:59:43.880610 [debug] [ThreadPool]: On list_baliza_dbt: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "connection_name": "list_baliza_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"baliza_dbt"'
    
  
  
[0m15:59:43.881026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:44.081055 [debug] [ThreadPool]: SQL status: OK in 0.200 seconds
[0m15:59:44.082360 [debug] [ThreadPool]: On list_baliza_dbt: Close
[0m15:59:44.083301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_baliza_dbt, now create_baliza_dbt_main_staging)
[0m15:59:44.083753 [debug] [ThreadPool]: Creating schema "database: "baliza_dbt"
schema: "main_staging"
"
[0m15:59:44.088530 [debug] [ThreadPool]: Using duckdb connection "create_baliza_dbt_main_staging"
[0m15:59:44.088872 [debug] [ThreadPool]: On create_baliza_dbt_main_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "connection_name": "create_baliza_dbt_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='baliza_dbt'
        and type='sqlite'
    
  
[0m15:59:44.089161 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:44.091036 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:59:44.092438 [debug] [ThreadPool]: Using duckdb connection "create_baliza_dbt_main_staging"
[0m15:59:44.093264 [debug] [ThreadPool]: On create_baliza_dbt_main_staging: BEGIN
[0m15:59:44.094632 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:59:44.095403 [debug] [ThreadPool]: Using duckdb connection "create_baliza_dbt_main_staging"
[0m15:59:44.095681 [debug] [ThreadPool]: On create_baliza_dbt_main_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "connection_name": "create_baliza_dbt_main_staging"} */

    
    
        create schema if not exists "baliza_dbt"."main_staging"
    
[0m15:59:44.096437 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:59:44.097206 [debug] [ThreadPool]: On create_baliza_dbt_main_staging: COMMIT
[0m15:59:44.097516 [debug] [ThreadPool]: Using duckdb connection "create_baliza_dbt_main_staging"
[0m15:59:44.097768 [debug] [ThreadPool]: On create_baliza_dbt_main_staging: COMMIT
[0m15:59:44.105674 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m15:59:44.106159 [debug] [ThreadPool]: On create_baliza_dbt_main_staging: Close
[0m15:59:44.113285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_baliza_dbt_main_staging, now list_baliza_dbt_main_analytics)
[0m15:59:44.117761 [debug] [ThreadPool]: Using duckdb connection "list_baliza_dbt_main_analytics"
[0m15:59:44.118260 [debug] [ThreadPool]: On list_baliza_dbt_main_analytics: BEGIN
[0m15:59:44.118593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:44.120805 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:59:44.121202 [debug] [ThreadPool]: Using duckdb connection "list_baliza_dbt_main_analytics"
[0m15:59:44.121542 [debug] [ThreadPool]: On list_baliza_dbt_main_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "connection_name": "list_baliza_dbt_main_analytics"} */
select
      'baliza_dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analytics'
    and lower(table_catalog) = 'baliza_dbt'
  
[0m15:59:44.132534 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m15:59:44.133730 [debug] [ThreadPool]: On list_baliza_dbt_main_analytics: ROLLBACK
[0m15:59:44.134586 [debug] [ThreadPool]: Failed to rollback 'list_baliza_dbt_main_analytics'
[0m15:59:44.134915 [debug] [ThreadPool]: On list_baliza_dbt_main_analytics: Close
[0m15:59:44.135590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_baliza_dbt_main_analytics, now list_baliza_dbt_main_staging)
[0m15:59:44.136930 [debug] [ThreadPool]: Using duckdb connection "list_baliza_dbt_main_staging"
[0m15:59:44.137288 [debug] [ThreadPool]: On list_baliza_dbt_main_staging: BEGIN
[0m15:59:44.137735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:44.139492 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:59:44.139839 [debug] [ThreadPool]: Using duckdb connection "list_baliza_dbt_main_staging"
[0m15:59:44.140113 [debug] [ThreadPool]: On list_baliza_dbt_main_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "connection_name": "list_baliza_dbt_main_staging"} */
select
      'baliza_dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'baliza_dbt'
  
[0m15:59:44.144120 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m15:59:44.146551 [debug] [ThreadPool]: On list_baliza_dbt_main_staging: ROLLBACK
[0m15:59:44.147302 [debug] [ThreadPool]: Failed to rollback 'list_baliza_dbt_main_staging'
[0m15:59:44.147621 [debug] [ThreadPool]: On list_baliza_dbt_main_staging: Close
[0m15:59:44.148256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_baliza_dbt_main_staging, now list_baliza_dbt_main_marts)
[0m15:59:44.149547 [debug] [ThreadPool]: Using duckdb connection "list_baliza_dbt_main_marts"
[0m15:59:44.149828 [debug] [ThreadPool]: On list_baliza_dbt_main_marts: BEGIN
[0m15:59:44.150085 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:44.151297 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:59:44.151592 [debug] [ThreadPool]: Using duckdb connection "list_baliza_dbt_main_marts"
[0m15:59:44.151847 [debug] [ThreadPool]: On list_baliza_dbt_main_marts: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "connection_name": "list_baliza_dbt_main_marts"} */
select
      'baliza_dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'baliza_dbt'
  
[0m15:59:44.154086 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:59:44.155112 [debug] [ThreadPool]: On list_baliza_dbt_main_marts: ROLLBACK
[0m15:59:44.155675 [debug] [ThreadPool]: Failed to rollback 'list_baliza_dbt_main_marts'
[0m15:59:44.155941 [debug] [ThreadPool]: On list_baliza_dbt_main_marts: Close
[0m15:59:44.156902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23d974a5-89ec-4382-b1fb-f29a3da6e14e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4019e10e90>]}
[0m15:59:44.157603 [debug] [MainThread]: Using duckdb connection "master"
[0m15:59:44.157992 [debug] [MainThread]: On master: BEGIN
[0m15:59:44.158279 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:59:44.161516 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m15:59:44.163080 [debug] [MainThread]: On master: COMMIT
[0m15:59:44.163522 [debug] [MainThread]: Using duckdb connection "master"
[0m15:59:44.163846 [debug] [MainThread]: On master: COMMIT
[0m15:59:44.164714 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:59:44.165066 [debug] [MainThread]: On master: Close
[0m15:59:44.172814 [debug] [Thread-1 (]: Began running node model.baliza.stg_contratos
[0m15:59:44.174647 [info ] [Thread-1 (]: 1 of 1 START sql view model main_staging.stg_contratos ......................... [RUN]
[0m15:59:44.175758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_baliza_dbt_main_marts, now model.baliza.stg_contratos)
[0m15:59:44.176532 [debug] [Thread-1 (]: Began compiling node model.baliza.stg_contratos
[0m15:59:44.183302 [debug] [Thread-1 (]: Writing injected SQL for node "model.baliza.stg_contratos"
[0m15:59:44.185745 [debug] [Thread-1 (]: Began executing node model.baliza.stg_contratos
[0m15:59:44.213651 [debug] [Thread-1 (]: Writing runtime sql for node "model.baliza.stg_contratos"
[0m15:59:44.216042 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.stg_contratos"
[0m15:59:44.216790 [debug] [Thread-1 (]: On model.baliza.stg_contratos: BEGIN
[0m15:59:44.217231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:44.219101 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:59:44.219600 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.stg_contratos"
[0m15:59:44.220165 [debug] [Thread-1 (]: On model.baliza.stg_contratos: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "model.baliza.stg_contratos"} */

  
  create view "baliza_dbt"."main_staging"."stg_contratos__dbt_tmp" as (
    -- Staging model: Clean and standardize raw contract data


WITH contratos_cleaned AS (
    SELECT 
        -- Business keys and identifiers
        numeroControlePncpCompra AS contrato_id,
        baliza_run_id,
        baliza_data_date,
        baliza_extracted_at,
        
        -- Contract basic info
        numeroContratoEmpenho AS numero_contrato,
        anoContrato AS ano_contrato,
        
        -- Dates (convert from string to proper dates)
        TRY_CAST(dataAssinatura AS DATE) AS data_assinatura,
        TRY_CAST(dataVigenciaInicio AS DATE) AS data_vigencia_inicio,
        TRY_CAST(dataVigenciaFim AS DATE) AS data_vigencia_fim,
        
        -- Financial values (ensure proper numeric types)
        COALESCE(valorInicial, 0)::DECIMAL(18,2) AS valor_inicial_brl,
        COALESCE(valorParcela, 0)::DECIMAL(18,2) AS valor_parcela_brl,
        COALESCE(valorGlobal, 0)::DECIMAL(18,2) AS valor_global_brl,
        COALESCE(valorAcumulado, 0)::DECIMAL(18,2) AS valor_acumulado_brl,
        
        -- Supplier information
        niFornecedor AS fornecedor_ni,
        tipoPessoa AS fornecedor_tipo_pessoa,
        nomeRazaoSocialFornecedor AS fornecedor_nome,
        codigoPaisFornecedor AS fornecedor_pais_codigo,
        
        -- Contract object
        objetoContrato AS objeto_contrato,
        
        -- Extract structured data from JSON fields
        JSON_EXTRACT_STRING(tipoContrato_json, '$.nome') AS tipo_contrato_nome,
        JSON_EXTRACT_STRING(tipoContrato_json, '$.id') AS tipo_contrato_id,
        
        JSON_EXTRACT_STRING(orgaoEntidade_json, '$.cnpj') AS orgao_cnpj,
        JSON_EXTRACT_STRING(orgaoEntidade_json, '$.razaoSocial') AS orgao_razao_social,
        JSON_EXTRACT_STRING(orgaoEntidade_json, '$.poderId') AS orgao_poder_id,
        JSON_EXTRACT_STRING(orgaoEntidade_json, '$.esferaId') AS orgao_esfera_id,
        
        JSON_EXTRACT_STRING(categoriaProcesso_json, '$.nome') AS categoria_processo_nome,
        JSON_EXTRACT_STRING(categoriaProcesso_json, '$.id') AS categoria_processo_id,
        
        JSON_EXTRACT_STRING(unidadeOrgao_json, '$.ufNome') AS uf_nome,
        JSON_EXTRACT_STRING(unidadeOrgao_json, '$.ufSigla') AS uf_sigla,
        JSON_EXTRACT_STRING(unidadeOrgao_json, '$.municipioNome') AS municipio_nome,
        JSON_EXTRACT_STRING(unidadeOrgao_json, '$.codigoIbge') AS municipio_codigo_ibge,
        JSON_EXTRACT_STRING(unidadeOrgao_json, '$.nomeUnidade') AS unidade_nome,
        JSON_EXTRACT_STRING(unidadeOrgao_json, '$.codigoUnidade') AS unidade_codigo,
        
        -- Calculated fields
        CASE 
            WHEN TRY_CAST(dataVigenciaFim AS DATE) IS NOT NULL 
                 AND TRY_CAST(dataVigenciaInicio AS DATE) IS NOT NULL
            THEN DATE_DIFF('day', 
                          TRY_CAST(dataVigenciaInicio AS DATE), 
                          TRY_CAST(dataVigenciaFim AS DATE))
            ELSE NULL
        END AS duracao_contrato_dias,
        
        -- Data quality flags
        CASE 
            WHEN valorGlobal > 1000000 THEN TRUE 
            ELSE FALSE 
        END AS flag_valor_suspeito,
        
        CASE 
            WHEN DATE_DIFF('day', 
                          TRY_CAST(dataVigenciaInicio AS DATE), 
                          TRY_CAST(dataVigenciaFim AS DATE)) > 1460
            THEN TRUE 
            ELSE FALSE 
        END AS flag_duracao_suspeita,
        
        -- Raw JSON for complex analysis
        raw_data_json
        
    FROM "baliza_dbt"."psa"."contratos_raw"
    WHERE baliza_data_date >= '2025-01-01'
)

SELECT * FROM contratos_cleaned
  );

[0m15:59:44.222369 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:59:44.230285 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.stg_contratos"
[0m15:59:44.230873 [debug] [Thread-1 (]: On model.baliza.stg_contratos: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "model.baliza.stg_contratos"} */
alter view "baliza_dbt"."main_staging"."stg_contratos__dbt_tmp" rename to "stg_contratos"
[0m15:59:44.232606 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:44.239474 [debug] [Thread-1 (]: On model.baliza.stg_contratos: COMMIT
[0m15:59:44.239904 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.stg_contratos"
[0m15:59:44.240201 [debug] [Thread-1 (]: On model.baliza.stg_contratos: COMMIT
[0m15:59:44.246305 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:59:44.250479 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.stg_contratos"
[0m15:59:44.250983 [debug] [Thread-1 (]: On model.baliza.stg_contratos: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "model.baliza.stg_contratos"} */

      drop view if exists "baliza_dbt"."main_staging"."stg_contratos__dbt_backup" cascade
    
[0m15:59:44.251982 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:44.253804 [debug] [Thread-1 (]: On model.baliza.stg_contratos: Close
[0m15:59:44.255377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23d974a5-89ec-4382-b1fb-f29a3da6e14e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a401a93f800>]}
[0m15:59:44.255979 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main_staging.stg_contratos .................... [[32mOK[0m in 0.08s]
[0m15:59:44.256539 [debug] [Thread-1 (]: Finished running node model.baliza.stg_contratos
[0m15:59:44.258823 [debug] [MainThread]: Using duckdb connection "master"
[0m15:59:44.259699 [debug] [MainThread]: On master: BEGIN
[0m15:59:44.260387 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:59:44.262174 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:59:44.262517 [debug] [MainThread]: On master: COMMIT
[0m15:59:44.262780 [debug] [MainThread]: Using duckdb connection "master"
[0m15:59:44.263133 [debug] [MainThread]: On master: COMMIT
[0m15:59:44.263712 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:59:44.263971 [debug] [MainThread]: On master: Close
[0m15:59:44.264388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:44.264625 [debug] [MainThread]: Connection 'model.baliza.stg_contratos' was properly closed.
[0m15:59:44.264987 [info ] [MainThread]: 
[0m15:59:44.265286 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m15:59:44.265842 [debug] [MainThread]: Command end result
[0m15:59:44.282988 [debug] [MainThread]: Wrote artifact WritableManifest to /home/frank/workspace/baliza/dbt_baliza/target/manifest.json
[0m15:59:44.284787 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/frank/workspace/baliza/dbt_baliza/target/semantic_manifest.json
[0m15:59:44.288896 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/frank/workspace/baliza/dbt_baliza/target/run_results.json
[0m15:59:44.289216 [info ] [MainThread]: 
[0m15:59:44.289597 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:59:44.289902 [info ] [MainThread]: 
[0m15:59:44.290207 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:59:44.291013 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9097959, "process_in_blocks": "872", "process_kernel_time": 0.348114, "process_mem_max_rss": "184680", "process_out_blocks": "3280", "process_user_time": 3.608791}
[0m15:59:44.291534 [debug] [MainThread]: Command `dbt run` succeeded at 15:59:44.291420 after 1.91 seconds
[0m15:59:44.292193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4019dd39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a401a987920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a401a96f250>]}
[0m15:59:44.292800 [debug] [MainThread]: Flushing usage events
[0m15:59:45.242817 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:56.082987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761ef72d3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761ef5f67d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761ef5f679d0>]}


============================== 15:59:56.085531 | acf7b9b0-7b6e-4dea-8053-2f2a36f11249 ==============================
[0m15:59:56.085531 [info ] [MainThread]: Running with dbt=1.10.4
[0m15:59:56.086054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/frank/workspace/baliza/dbt_baliza/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:59:56.252979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acf7b9b0-7b6e-4dea-8053-2f2a36f11249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761ef6c53820>]}
[0m15:59:56.298802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acf7b9b0-7b6e-4dea-8053-2f2a36f11249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761ef61f1370>]}
[0m15:59:56.300188 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m15:59:56.346311 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m15:59:56.443123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:59:56.443564 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:59:56.447990 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.baliza
- snapshots.baliza
[0m15:59:56.483751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acf7b9b0-7b6e-4dea-8053-2f2a36f11249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761ef6023b50>]}
[0m15:59:56.559754 [debug] [MainThread]: Wrote artifact WritableManifest to /home/frank/workspace/baliza/dbt_baliza/target/manifest.json
[0m15:59:56.562515 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/frank/workspace/baliza/dbt_baliza/target/semantic_manifest.json
[0m15:59:56.576428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acf7b9b0-7b6e-4dea-8053-2f2a36f11249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761ef5fea3f0>]}
[0m15:59:56.577297 [info ] [MainThread]: Found 4 models, 14 data tests, 2 sources, 432 macros
[0m15:59:56.577832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acf7b9b0-7b6e-4dea-8053-2f2a36f11249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761ef1f2c590>]}
[0m15:59:56.579684 [info ] [MainThread]: 
[0m15:59:56.580076 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:59:56.580383 [info ] [MainThread]: 
[0m15:59:56.580863 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:59:56.585025 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_baliza_dbt'
[0m15:59:56.614996 [debug] [ThreadPool]: Using duckdb connection "list_baliza_dbt"
[0m15:59:56.615910 [debug] [ThreadPool]: On list_baliza_dbt: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "connection_name": "list_baliza_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"baliza_dbt"'
    
  
  
[0m15:59:56.616511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:56.807842 [debug] [ThreadPool]: SQL status: OK in 0.191 seconds
[0m15:59:56.809452 [debug] [ThreadPool]: On list_baliza_dbt: Close
[0m15:59:56.811941 [debug] [ThreadPool]: Using duckdb connection "list_baliza_dbt"
[0m15:59:56.812492 [debug] [ThreadPool]: On list_baliza_dbt: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "connection_name": "list_baliza_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"baliza_dbt"'
    
  
  
[0m15:59:56.812891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:56.815235 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:59:56.816455 [debug] [ThreadPool]: On list_baliza_dbt: Close
[0m15:59:56.818415 [debug] [ThreadPool]: Using duckdb connection "list_baliza_dbt"
[0m15:59:56.818927 [debug] [ThreadPool]: On list_baliza_dbt: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "connection_name": "list_baliza_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"baliza_dbt"'
    
  
  
[0m15:59:56.819252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:56.821300 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:59:56.823320 [debug] [ThreadPool]: On list_baliza_dbt: Close
[0m15:59:56.825509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_baliza_dbt, now create_baliza_dbt_main_analytics)
[0m15:59:56.826253 [debug] [ThreadPool]: Creating schema "database: "baliza_dbt"
schema: "main_analytics"
"
[0m15:59:56.831829 [debug] [ThreadPool]: Using duckdb connection "create_baliza_dbt_main_analytics"
[0m15:59:56.832256 [debug] [ThreadPool]: On create_baliza_dbt_main_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "connection_name": "create_baliza_dbt_main_analytics"} */

    
        select type from duckdb_databases()
        where lower(database_name)='baliza_dbt'
        and type='sqlite'
    
  
[0m15:59:56.832532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:56.834340 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:59:56.835543 [debug] [ThreadPool]: Using duckdb connection "create_baliza_dbt_main_analytics"
[0m15:59:56.835910 [debug] [ThreadPool]: On create_baliza_dbt_main_analytics: BEGIN
[0m15:59:56.836796 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:59:56.837216 [debug] [ThreadPool]: Using duckdb connection "create_baliza_dbt_main_analytics"
[0m15:59:56.837515 [debug] [ThreadPool]: On create_baliza_dbt_main_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "connection_name": "create_baliza_dbt_main_analytics"} */

    
    
        create schema if not exists "baliza_dbt"."main_analytics"
    
[0m15:59:56.838664 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:59:56.840584 [debug] [ThreadPool]: On create_baliza_dbt_main_analytics: COMMIT
[0m15:59:56.841350 [debug] [ThreadPool]: Using duckdb connection "create_baliza_dbt_main_analytics"
[0m15:59:56.841664 [debug] [ThreadPool]: On create_baliza_dbt_main_analytics: COMMIT
[0m15:59:56.846536 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m15:59:56.847189 [debug] [ThreadPool]: On create_baliza_dbt_main_analytics: Close
[0m15:59:56.848137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_baliza_dbt_main_analytics, now create_baliza_dbt_main_staging)
[0m15:59:56.848874 [debug] [ThreadPool]: Creating schema "database: "baliza_dbt"
schema: "main_staging"
"
[0m15:59:56.851243 [debug] [ThreadPool]: Using duckdb connection "create_baliza_dbt_main_staging"
[0m15:59:56.851922 [debug] [ThreadPool]: On create_baliza_dbt_main_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "connection_name": "create_baliza_dbt_main_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='baliza_dbt'
        and type='sqlite'
    
  
[0m15:59:56.852355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:56.863269 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m15:59:56.865306 [debug] [ThreadPool]: Using duckdb connection "create_baliza_dbt_main_staging"
[0m15:59:56.865869 [debug] [ThreadPool]: On create_baliza_dbt_main_staging: BEGIN
[0m15:59:56.866901 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:59:56.867425 [debug] [ThreadPool]: Using duckdb connection "create_baliza_dbt_main_staging"
[0m15:59:56.867839 [debug] [ThreadPool]: On create_baliza_dbt_main_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "connection_name": "create_baliza_dbt_main_staging"} */

    
    
        create schema if not exists "baliza_dbt"."main_staging"
    
[0m15:59:56.868965 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:59:56.870202 [debug] [ThreadPool]: On create_baliza_dbt_main_staging: COMMIT
[0m15:59:56.870763 [debug] [ThreadPool]: Using duckdb connection "create_baliza_dbt_main_staging"
[0m15:59:56.871200 [debug] [ThreadPool]: On create_baliza_dbt_main_staging: COMMIT
[0m15:59:56.872175 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:59:56.872958 [debug] [ThreadPool]: On create_baliza_dbt_main_staging: Close
[0m15:59:56.874008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_baliza_dbt_main_staging, now create_baliza_dbt_main_marts)
[0m15:59:56.874786 [debug] [ThreadPool]: Creating schema "database: "baliza_dbt"
schema: "main_marts"
"
[0m15:59:56.877690 [debug] [ThreadPool]: Using duckdb connection "create_baliza_dbt_main_marts"
[0m15:59:56.878336 [debug] [ThreadPool]: On create_baliza_dbt_main_marts: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "connection_name": "create_baliza_dbt_main_marts"} */

    
        select type from duckdb_databases()
        where lower(database_name)='baliza_dbt'
        and type='sqlite'
    
  
[0m15:59:56.878759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:56.881459 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:59:56.884082 [debug] [ThreadPool]: Using duckdb connection "create_baliza_dbt_main_marts"
[0m15:59:56.884698 [debug] [ThreadPool]: On create_baliza_dbt_main_marts: BEGIN
[0m15:59:56.885666 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:59:56.886112 [debug] [ThreadPool]: Using duckdb connection "create_baliza_dbt_main_marts"
[0m15:59:56.886477 [debug] [ThreadPool]: On create_baliza_dbt_main_marts: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "connection_name": "create_baliza_dbt_main_marts"} */

    
    
        create schema if not exists "baliza_dbt"."main_marts"
    
[0m15:59:56.887636 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:59:56.889954 [debug] [ThreadPool]: On create_baliza_dbt_main_marts: COMMIT
[0m15:59:56.891143 [debug] [ThreadPool]: Using duckdb connection "create_baliza_dbt_main_marts"
[0m15:59:56.891609 [debug] [ThreadPool]: On create_baliza_dbt_main_marts: COMMIT
[0m15:59:56.900418 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m15:59:56.901120 [debug] [ThreadPool]: On create_baliza_dbt_main_marts: Close
[0m15:59:56.903824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_baliza_dbt_main_marts, now list_baliza_dbt_main_analytics)
[0m15:59:56.911323 [debug] [ThreadPool]: Using duckdb connection "list_baliza_dbt_main_analytics"
[0m15:59:56.912024 [debug] [ThreadPool]: On list_baliza_dbt_main_analytics: BEGIN
[0m15:59:56.912353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:56.914180 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:59:56.914557 [debug] [ThreadPool]: Using duckdb connection "list_baliza_dbt_main_analytics"
[0m15:59:56.914872 [debug] [ThreadPool]: On list_baliza_dbt_main_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "connection_name": "list_baliza_dbt_main_analytics"} */
select
      'baliza_dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analytics'
    and lower(table_catalog) = 'baliza_dbt'
  
[0m15:59:56.927117 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m15:59:56.929075 [debug] [ThreadPool]: On list_baliza_dbt_main_analytics: ROLLBACK
[0m15:59:56.930454 [debug] [ThreadPool]: Failed to rollback 'list_baliza_dbt_main_analytics'
[0m15:59:56.930996 [debug] [ThreadPool]: On list_baliza_dbt_main_analytics: Close
[0m15:59:56.931944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_baliza_dbt_main_analytics, now list_baliza_dbt_main_staging)
[0m15:59:56.934131 [debug] [ThreadPool]: Using duckdb connection "list_baliza_dbt_main_staging"
[0m15:59:56.934580 [debug] [ThreadPool]: On list_baliza_dbt_main_staging: BEGIN
[0m15:59:56.935026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:56.937459 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:59:56.938184 [debug] [ThreadPool]: Using duckdb connection "list_baliza_dbt_main_staging"
[0m15:59:56.938670 [debug] [ThreadPool]: On list_baliza_dbt_main_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "connection_name": "list_baliza_dbt_main_staging"} */
select
      'baliza_dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'baliza_dbt'
  
[0m15:59:56.942250 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:59:56.943553 [debug] [ThreadPool]: On list_baliza_dbt_main_staging: ROLLBACK
[0m15:59:56.944173 [debug] [ThreadPool]: Failed to rollback 'list_baliza_dbt_main_staging'
[0m15:59:56.944470 [debug] [ThreadPool]: On list_baliza_dbt_main_staging: Close
[0m15:59:56.945085 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_baliza_dbt_main_staging, now list_baliza_dbt_main_marts)
[0m15:59:56.947030 [debug] [ThreadPool]: Using duckdb connection "list_baliza_dbt_main_marts"
[0m15:59:56.947354 [debug] [ThreadPool]: On list_baliza_dbt_main_marts: BEGIN
[0m15:59:56.947615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:56.948873 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:59:56.949170 [debug] [ThreadPool]: Using duckdb connection "list_baliza_dbt_main_marts"
[0m15:59:56.949447 [debug] [ThreadPool]: On list_baliza_dbt_main_marts: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "connection_name": "list_baliza_dbt_main_marts"} */
select
      'baliza_dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'baliza_dbt'
  
[0m15:59:56.951993 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:59:56.953339 [debug] [ThreadPool]: On list_baliza_dbt_main_marts: ROLLBACK
[0m15:59:56.954143 [debug] [ThreadPool]: Failed to rollback 'list_baliza_dbt_main_marts'
[0m15:59:56.954600 [debug] [ThreadPool]: On list_baliza_dbt_main_marts: Close
[0m15:59:56.955701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acf7b9b0-7b6e-4dea-8053-2f2a36f11249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761ef107db20>]}
[0m15:59:56.956197 [debug] [MainThread]: Using duckdb connection "master"
[0m15:59:56.956495 [debug] [MainThread]: On master: BEGIN
[0m15:59:56.956752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:59:56.958199 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:59:56.958529 [debug] [MainThread]: On master: COMMIT
[0m15:59:56.958788 [debug] [MainThread]: Using duckdb connection "master"
[0m15:59:56.959086 [debug] [MainThread]: On master: COMMIT
[0m15:59:56.959610 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:59:56.959995 [debug] [MainThread]: On master: Close
[0m15:59:56.962239 [debug] [Thread-1 (]: Began running node model.baliza.stg_contratos
[0m15:59:56.962879 [info ] [Thread-1 (]: 1 of 4 START sql view model main_staging.stg_contratos ......................... [RUN]
[0m15:59:56.963383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_baliza_dbt_main_marts, now model.baliza.stg_contratos)
[0m15:59:56.963801 [debug] [Thread-1 (]: Began compiling node model.baliza.stg_contratos
[0m15:59:56.970492 [debug] [Thread-1 (]: Writing injected SQL for node "model.baliza.stg_contratos"
[0m15:59:56.971434 [debug] [Thread-1 (]: Began executing node model.baliza.stg_contratos
[0m15:59:56.994557 [debug] [Thread-1 (]: Writing runtime sql for node "model.baliza.stg_contratos"
[0m15:59:56.995438 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.stg_contratos"
[0m15:59:56.995813 [debug] [Thread-1 (]: On model.baliza.stg_contratos: BEGIN
[0m15:59:56.996115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:56.997634 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:56.997973 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.stg_contratos"
[0m15:59:56.998329 [debug] [Thread-1 (]: On model.baliza.stg_contratos: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "model.baliza.stg_contratos"} */

  
  create view "baliza_dbt"."main_staging"."stg_contratos__dbt_tmp" as (
    -- Staging model: Clean and standardize raw contract data


WITH contratos_cleaned AS (
    SELECT 
        -- Business keys and identifiers
        numeroControlePncpCompra AS contrato_id,
        baliza_run_id,
        baliza_data_date,
        baliza_extracted_at,
        
        -- Contract basic info
        numeroContratoEmpenho AS numero_contrato,
        anoContrato AS ano_contrato,
        
        -- Dates (convert from string to proper dates)
        TRY_CAST(dataAssinatura AS DATE) AS data_assinatura,
        TRY_CAST(dataVigenciaInicio AS DATE) AS data_vigencia_inicio,
        TRY_CAST(dataVigenciaFim AS DATE) AS data_vigencia_fim,
        
        -- Financial values (ensure proper numeric types)
        COALESCE(valorInicial, 0)::DECIMAL(18,2) AS valor_inicial_brl,
        COALESCE(valorParcela, 0)::DECIMAL(18,2) AS valor_parcela_brl,
        COALESCE(valorGlobal, 0)::DECIMAL(18,2) AS valor_global_brl,
        COALESCE(valorAcumulado, 0)::DECIMAL(18,2) AS valor_acumulado_brl,
        
        -- Supplier information
        niFornecedor AS fornecedor_ni,
        tipoPessoa AS fornecedor_tipo_pessoa,
        nomeRazaoSocialFornecedor AS fornecedor_nome,
        codigoPaisFornecedor AS fornecedor_pais_codigo,
        
        -- Contract object
        objetoContrato AS objeto_contrato,
        
        -- Extract structured data from JSON fields
        JSON_EXTRACT_STRING(tipoContrato_json, '$.nome') AS tipo_contrato_nome,
        JSON_EXTRACT_STRING(tipoContrato_json, '$.id') AS tipo_contrato_id,
        
        JSON_EXTRACT_STRING(orgaoEntidade_json, '$.cnpj') AS orgao_cnpj,
        JSON_EXTRACT_STRING(orgaoEntidade_json, '$.razaoSocial') AS orgao_razao_social,
        JSON_EXTRACT_STRING(orgaoEntidade_json, '$.poderId') AS orgao_poder_id,
        JSON_EXTRACT_STRING(orgaoEntidade_json, '$.esferaId') AS orgao_esfera_id,
        
        JSON_EXTRACT_STRING(categoriaProcesso_json, '$.nome') AS categoria_processo_nome,
        JSON_EXTRACT_STRING(categoriaProcesso_json, '$.id') AS categoria_processo_id,
        
        JSON_EXTRACT_STRING(unidadeOrgao_json, '$.ufNome') AS uf_nome,
        JSON_EXTRACT_STRING(unidadeOrgao_json, '$.ufSigla') AS uf_sigla,
        JSON_EXTRACT_STRING(unidadeOrgao_json, '$.municipioNome') AS municipio_nome,
        JSON_EXTRACT_STRING(unidadeOrgao_json, '$.codigoIbge') AS municipio_codigo_ibge,
        JSON_EXTRACT_STRING(unidadeOrgao_json, '$.nomeUnidade') AS unidade_nome,
        JSON_EXTRACT_STRING(unidadeOrgao_json, '$.codigoUnidade') AS unidade_codigo,
        
        -- Calculated fields
        CASE 
            WHEN TRY_CAST(dataVigenciaFim AS DATE) IS NOT NULL 
                 AND TRY_CAST(dataVigenciaInicio AS DATE) IS NOT NULL
            THEN DATE_DIFF('day', 
                          TRY_CAST(dataVigenciaInicio AS DATE), 
                          TRY_CAST(dataVigenciaFim AS DATE))
            ELSE NULL
        END AS duracao_contrato_dias,
        
        -- Data quality flags
        CASE 
            WHEN valorGlobal > 1000000 THEN TRUE 
            ELSE FALSE 
        END AS flag_valor_suspeito,
        
        CASE 
            WHEN DATE_DIFF('day', 
                          TRY_CAST(dataVigenciaInicio AS DATE), 
                          TRY_CAST(dataVigenciaFim AS DATE)) > 1460
            THEN TRUE 
            ELSE FALSE 
        END AS flag_duracao_suspeita,
        
        -- Raw JSON for complex analysis
        raw_data_json
        
    FROM "baliza_dbt"."psa"."contratos_raw"
    WHERE baliza_data_date >= '2025-01-01'
)

SELECT * FROM contratos_cleaned
  );

[0m15:59:56.999883 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:57.005471 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.stg_contratos"
[0m15:59:57.005981 [debug] [Thread-1 (]: On model.baliza.stg_contratos: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "model.baliza.stg_contratos"} */
alter view "baliza_dbt"."main_staging"."stg_contratos" rename to "stg_contratos__dbt_backup"
[0m15:59:57.007122 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:57.009595 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.stg_contratos"
[0m15:59:57.009929 [debug] [Thread-1 (]: On model.baliza.stg_contratos: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "model.baliza.stg_contratos"} */
alter view "baliza_dbt"."main_staging"."stg_contratos__dbt_tmp" rename to "stg_contratos"
[0m15:59:57.010797 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:57.018843 [debug] [Thread-1 (]: On model.baliza.stg_contratos: COMMIT
[0m15:59:57.019327 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.stg_contratos"
[0m15:59:57.019762 [debug] [Thread-1 (]: On model.baliza.stg_contratos: COMMIT
[0m15:59:57.025479 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:59:57.029518 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.stg_contratos"
[0m15:59:57.029890 [debug] [Thread-1 (]: On model.baliza.stg_contratos: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "model.baliza.stg_contratos"} */

      drop view if exists "baliza_dbt"."main_staging"."stg_contratos__dbt_backup" cascade
    
[0m15:59:57.034684 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:59:57.036975 [debug] [Thread-1 (]: On model.baliza.stg_contratos: Close
[0m15:59:57.039221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acf7b9b0-7b6e-4dea-8053-2f2a36f11249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761ef11a4dd0>]}
[0m15:59:57.040051 [info ] [Thread-1 (]: 1 of 4 OK created sql view model main_staging.stg_contratos .................... [[32mOK[0m in 0.07s]
[0m15:59:57.041047 [debug] [Thread-1 (]: Finished running node model.baliza.stg_contratos
[0m15:59:57.042135 [debug] [Thread-1 (]: Began running node model.baliza.dashboard_metrics
[0m15:59:57.042671 [info ] [Thread-1 (]: 2 of 4 START sql table model main_analytics.dashboard_metrics .................. [RUN]
[0m15:59:57.043607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.baliza.stg_contratos, now model.baliza.dashboard_metrics)
[0m15:59:57.043994 [debug] [Thread-1 (]: Began compiling node model.baliza.dashboard_metrics
[0m15:59:57.047202 [debug] [Thread-1 (]: Writing injected SQL for node "model.baliza.dashboard_metrics"
[0m15:59:57.048077 [debug] [Thread-1 (]: Began executing node model.baliza.dashboard_metrics
[0m15:59:57.062648 [debug] [Thread-1 (]: Writing runtime sql for node "model.baliza.dashboard_metrics"
[0m15:59:57.063690 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.dashboard_metrics"
[0m15:59:57.064027 [debug] [Thread-1 (]: On model.baliza.dashboard_metrics: BEGIN
[0m15:59:57.064303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:57.065708 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:57.066034 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.dashboard_metrics"
[0m15:59:57.066413 [debug] [Thread-1 (]: On model.baliza.dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "model.baliza.dashboard_metrics"} */

  
    
    

    create  table
      "baliza_dbt"."main_analytics"."dashboard_metrics__dbt_tmp"
  
    as (
      -- Analytics model: Dashboard metrics and KPIs


WITH daily_metrics AS (
    SELECT 
        baliza_data_date AS data_referencia,
        uf_sigla,
        categoria_processo_nome,
        orgao_poder_id,
        orgao_esfera_id,
        
        -- Volume metrics
        COUNT(DISTINCT contrato_id) AS total_contratos,
        COUNT(DISTINCT orgao_cnpj) AS total_orgaos,
        COUNT(DISTINCT fornecedor_ni) AS total_fornecedores,
        
        -- Financial metrics (in millions BRL)
        ROUND(SUM(valor_global_brl) / 1000000, 2) AS valor_total_milhoes_brl,
        ROUND(AVG(valor_global_brl) / 1000000, 4) AS valor_medio_milhoes_brl,
        ROUND(PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY valor_global_brl) / 1000000, 4) AS valor_mediano_milhoes_brl,
        ROUND(MAX(valor_global_brl) / 1000000, 2) AS valor_maximo_milhoes_brl,
        
        -- Duration metrics
        AVG(duracao_contrato_dias) AS duracao_media_dias,
        PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY duracao_contrato_dias) AS duracao_mediana_dias,
        MAX(duracao_contrato_dias) AS duracao_maxima_dias,
        
        -- Risk metrics
        SUM(CASE WHEN flag_valor_suspeito THEN 1 ELSE 0 END) AS contratos_valor_suspeito,
        SUM(CASE WHEN flag_duracao_suspeita THEN 1 ELSE 0 END) AS contratos_duracao_suspeita,
        
        -- Percentages
        ROUND(
            100.0 * SUM(CASE WHEN flag_valor_suspeito THEN 1 ELSE 0 END) / COUNT(*), 
            2
        ) AS perc_valor_suspeito,
        
        -- Geographic distribution
        COUNT(DISTINCT municipio_codigo_ibge) AS total_municipios,
        
        -- Temporal patterns
        SUM(CASE WHEN EXTRACT(DOW FROM data_assinatura) IN (0, 6) THEN 1 ELSE 0 END) AS contratos_fim_semana,
        
        -- Emergency contracts (keywords in object)
        SUM(CASE 
            WHEN LOWER(objeto_contrato) LIKE '%emergenc%' 
                OR LOWER(objeto_contrato) LIKE '%urgente%' 
                OR LOWER(objeto_contrato) LIKE '%urgênci%'
            THEN 1 ELSE 0 
        END) AS contratos_emergencia
        
    FROM "baliza_dbt"."main_staging"."stg_contratos"
    WHERE baliza_data_date >= CURRENT_DATE - INTERVAL '30 days'  -- Last 30 days
    GROUP BY 1,2,3,4,5
),

enriched_metrics AS (
    SELECT 
        *,
        
        -- Growth rates (vs previous day)
        LAG(total_contratos) OVER (
            PARTITION BY uf_sigla, categoria_processo_nome 
            ORDER BY data_referencia
        ) AS contratos_dia_anterior,
        
        LAG(valor_total_milhoes_brl) OVER (
            PARTITION BY uf_sigla, categoria_processo_nome 
            ORDER BY data_referencia
        ) AS valor_dia_anterior,
        
        -- Moving averages (7-day)
        AVG(total_contratos) OVER (
            PARTITION BY uf_sigla, categoria_processo_nome 
            ORDER BY data_referencia 
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS contratos_media_7d,
        
        AVG(valor_total_milhoes_brl) OVER (
            PARTITION BY uf_sigla, categoria_processo_nome 
            ORDER BY data_referencia 
            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
        ) AS valor_media_7d_milhoes,
        
        -- Rankings
        ROW_NUMBER() OVER (
            PARTITION BY data_referencia 
            ORDER BY valor_total_milhoes_brl DESC
        ) AS rank_valor_diario,
        
        ROW_NUMBER() OVER (
            PARTITION BY data_referencia 
            ORDER BY total_contratos DESC
        ) AS rank_volume_diario
        
    FROM daily_metrics
),

final_metrics AS (
    SELECT 
        *,
        
        -- Growth calculations
        CASE 
            WHEN contratos_dia_anterior > 0 THEN 
                ROUND(100.0 * (total_contratos - contratos_dia_anterior) / contratos_dia_anterior, 2)
            ELSE NULL 
        END AS crescimento_contratos_perc,
        
        CASE 
            WHEN valor_dia_anterior > 0 THEN 
                ROUND(100.0 * (valor_total_milhoes_brl - valor_dia_anterior) / valor_dia_anterior, 2)
            ELSE NULL 
        END AS crescimento_valor_perc,
        
        -- Anomaly detection (simple z-score based)
        CASE 
            WHEN ABS(total_contratos - contratos_media_7d) > (2 * STDDEV(total_contratos) OVER (
                PARTITION BY uf_sigla, categoria_processo_nome 
                ORDER BY data_referencia 
                ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
            )) THEN TRUE 
            ELSE FALSE 
        END AS anomalia_volume,
        
        CASE 
            WHEN ABS(valor_total_milhoes_brl - valor_media_7d_milhoes) > (2 * STDDEV(valor_total_milhoes_brl) OVER (
                PARTITION BY uf_sigla, categoria_processo_nome 
                ORDER BY data_referencia 
                ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
            )) THEN TRUE 
            ELSE FALSE 
        END AS anomalia_valor
        
    FROM enriched_metrics
)

SELECT * FROM final_metrics
ORDER BY data_referencia DESC, valor_total_milhoes_brl DESC
    );
  
  
[0m15:59:57.075062 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m15:59:57.077267 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.dashboard_metrics"
[0m15:59:57.077607 [debug] [Thread-1 (]: On model.baliza.dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "model.baliza.dashboard_metrics"} */
alter table "baliza_dbt"."main_analytics"."dashboard_metrics__dbt_tmp" rename to "dashboard_metrics"
[0m15:59:57.078626 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:57.088415 [debug] [Thread-1 (]: On model.baliza.dashboard_metrics: COMMIT
[0m15:59:57.089055 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.dashboard_metrics"
[0m15:59:57.089378 [debug] [Thread-1 (]: On model.baliza.dashboard_metrics: COMMIT
[0m15:59:57.095138 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:59:57.096994 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.dashboard_metrics"
[0m15:59:57.097336 [debug] [Thread-1 (]: On model.baliza.dashboard_metrics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "model.baliza.dashboard_metrics"} */

      drop table if exists "baliza_dbt"."main_analytics"."dashboard_metrics__dbt_backup" cascade
    
[0m15:59:57.098185 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:59:57.099435 [debug] [Thread-1 (]: On model.baliza.dashboard_metrics: Close
[0m15:59:57.100179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acf7b9b0-7b6e-4dea-8053-2f2a36f11249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761ef1b37c20>]}
[0m15:59:57.100748 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main_analytics.dashboard_metrics ............. [[32mOK[0m in 0.06s]
[0m15:59:57.101317 [debug] [Thread-1 (]: Finished running node model.baliza.dashboard_metrics
[0m15:59:57.101803 [debug] [Thread-1 (]: Began running node model.baliza.dim_orgaos
[0m15:59:57.102348 [info ] [Thread-1 (]: 3 of 4 START sql table model main_marts.dim_orgaos ............................. [RUN]
[0m15:59:57.103106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.baliza.dashboard_metrics, now model.baliza.dim_orgaos)
[0m15:59:57.103579 [debug] [Thread-1 (]: Began compiling node model.baliza.dim_orgaos
[0m15:59:57.107619 [debug] [Thread-1 (]: Writing injected SQL for node "model.baliza.dim_orgaos"
[0m15:59:57.108609 [debug] [Thread-1 (]: Began executing node model.baliza.dim_orgaos
[0m15:59:57.178224 [debug] [Thread-1 (]: Writing runtime sql for node "model.baliza.dim_orgaos"
[0m15:59:57.180239 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.dim_orgaos"
[0m15:59:57.180616 [debug] [Thread-1 (]: On model.baliza.dim_orgaos: BEGIN
[0m15:59:57.180920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:57.182691 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:59:57.183068 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.dim_orgaos"
[0m15:59:57.183449 [debug] [Thread-1 (]: On model.baliza.dim_orgaos: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "model.baliza.dim_orgaos"} */

  
    
    

    create  table
      "baliza_dbt"."main_marts"."dim_orgaos__dbt_tmp"
  
    as (
      -- Dimension table: Government entities (órgãos)


WITH orgaos_agg AS (
    SELECT 
        orgao_cnpj,
        orgao_razao_social,
        orgao_poder_id,
        orgao_esfera_id,
        uf_sigla,
        uf_nome,
        
        -- Aggregated metrics
        COUNT(DISTINCT contrato_id) AS total_contratos,
        SUM(valor_global_brl) AS valor_total_contratado,
        AVG(valor_global_brl) AS valor_medio_contrato,
        MIN(data_assinatura) AS primeiro_contrato_data,
        MAX(data_assinatura) AS ultimo_contrato_data,
        
        -- Data quality metrics
        SUM(CASE WHEN flag_valor_suspeito THEN 1 ELSE 0 END) AS contratos_valor_suspeito,
        SUM(CASE WHEN flag_duracao_suspeita THEN 1 ELSE 0 END) AS contratos_duracao_suspeita,
        
        -- Most recent data
        MAX(baliza_extracted_at) AS ultima_atualizacao
        
    FROM "baliza_dbt"."main_staging"."stg_contratos"
    WHERE orgao_cnpj IS NOT NULL
    GROUP BY 1,2,3,4,5,6
),

orgaos_enriched AS (
    SELECT 
        *,
        
        -- Classifications
        CASE orgao_poder_id
            WHEN 'E' THEN 'Executivo'
            WHEN 'L' THEN 'Legislativo'
            WHEN 'J' THEN 'Judiciário'
            WHEN 'M' THEN 'Ministério Público'
            ELSE 'Outros'
        END AS poder_nome,
        
        CASE orgao_esfera_id
            WHEN 'F' THEN 'Federal'
            WHEN 'E' THEN 'Estadual'
            WHEN 'M' THEN 'Municipal'
            ELSE 'Outros'
        END AS esfera_nome,
        
        -- Risk scoring
        CASE 
            WHEN (contratos_valor_suspeito::FLOAT / NULLIF(total_contratos, 0)) > 0.1 THEN 'Alto'
            WHEN (contratos_valor_suspeito::FLOAT / NULLIF(total_contratos, 0)) > 0.05 THEN 'Médio'
            ELSE 'Baixo'
        END AS risco_valor,
        
        -- Performance metrics
        valor_total_contratado / NULLIF(total_contratos, 0) AS valor_medio_verificado,
        DATE_DIFF('day', primeiro_contrato_data, ultimo_contrato_data) AS periodo_atividade_dias
        
    FROM orgaos_agg
)

SELECT * FROM orgaos_enriched
    );
  
  
[0m15:59:57.193849 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m15:59:57.196171 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.dim_orgaos"
[0m15:59:57.196508 [debug] [Thread-1 (]: On model.baliza.dim_orgaos: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "model.baliza.dim_orgaos"} */
alter table "baliza_dbt"."main_marts"."dim_orgaos__dbt_tmp" rename to "dim_orgaos"
[0m15:59:57.197398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:57.198520 [debug] [Thread-1 (]: On model.baliza.dim_orgaos: COMMIT
[0m15:59:57.198933 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.dim_orgaos"
[0m15:59:57.199266 [debug] [Thread-1 (]: On model.baliza.dim_orgaos: COMMIT
[0m15:59:57.205563 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:59:57.207733 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.dim_orgaos"
[0m15:59:57.208186 [debug] [Thread-1 (]: On model.baliza.dim_orgaos: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "model.baliza.dim_orgaos"} */

      drop table if exists "baliza_dbt"."main_marts"."dim_orgaos__dbt_backup" cascade
    
[0m15:59:57.209342 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:57.210575 [debug] [Thread-1 (]: On model.baliza.dim_orgaos: Close
[0m15:59:57.212069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acf7b9b0-7b6e-4dea-8053-2f2a36f11249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761ef0caaa30>]}
[0m15:59:57.212853 [info ] [Thread-1 (]: 3 of 4 OK created sql table model main_marts.dim_orgaos ........................ [[32mOK[0m in 0.11s]
[0m15:59:57.213544 [debug] [Thread-1 (]: Finished running node model.baliza.dim_orgaos
[0m15:59:57.214493 [debug] [Thread-1 (]: Began running node model.baliza.contratos_suspeitos
[0m15:59:57.215074 [info ] [Thread-1 (]: 4 of 4 START sql table model main_analytics.contratos_suspeitos ................ [RUN]
[0m15:59:57.216117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.baliza.dim_orgaos, now model.baliza.contratos_suspeitos)
[0m15:59:57.216680 [debug] [Thread-1 (]: Began compiling node model.baliza.contratos_suspeitos
[0m15:59:57.220643 [debug] [Thread-1 (]: Writing injected SQL for node "model.baliza.contratos_suspeitos"
[0m15:59:57.221595 [debug] [Thread-1 (]: Began executing node model.baliza.contratos_suspeitos
[0m15:59:57.225029 [debug] [Thread-1 (]: Writing runtime sql for node "model.baliza.contratos_suspeitos"
[0m15:59:57.225936 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.contratos_suspeitos"
[0m15:59:57.226313 [debug] [Thread-1 (]: On model.baliza.contratos_suspeitos: BEGIN
[0m15:59:57.226622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:57.228237 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:59:57.228595 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.contratos_suspeitos"
[0m15:59:57.228958 [debug] [Thread-1 (]: On model.baliza.contratos_suspeitos: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "model.baliza.contratos_suspeitos"} */

  
    
    

    create  table
      "baliza_dbt"."main_analytics"."contratos_suspeitos__dbt_tmp"
  
    as (
      -- Analytics model: Suspicious contracts detection


WITH contratos_scored AS (
    SELECT 
        c.*,
        o.poder_nome,
        o.esfera_nome,
        o.risco_valor AS orgao_risco_valor,
        
        -- Suspicious patterns scoring (0-100)
        (
            -- High value contracts (20 points)
            CASE WHEN c.flag_valor_suspeito THEN 20 ELSE 0 END +
            
            -- Unusual duration (15 points)
            CASE WHEN c.flag_duracao_suspeita THEN 15 ELSE 0 END +
            
            -- Same supplier frequency (15 points)
            CASE WHEN fornecedor_freq.contratos_mesmo_fornecedor > 10 THEN 15 
                 WHEN fornecedor_freq.contratos_mesmo_fornecedor > 5 THEN 10
                 ELSE 0 END +
            
            -- Round number values (10 points)
            CASE WHEN c.valor_global_brl % 10000 = 0 AND c.valor_global_brl > 100000 THEN 10 ELSE 0 END +
            
            -- Weekend signature (5 points)
            CASE WHEN EXTRACT(DOW FROM c.data_assinatura) IN (0, 6) THEN 5 ELSE 0 END +
            
            -- High-risk entity (20 points)
            CASE WHEN o.risco_valor = 'Alto' THEN 20 
                 WHEN o.risco_valor = 'Médio' THEN 10 
                 ELSE 0 END +
            
            -- Very short contracts (10 points)
            CASE WHEN c.duracao_contrato_dias <= 1 THEN 10 ELSE 0 END +
            
            -- Emergency processes (5 points - based on object keywords)
            CASE WHEN LOWER(c.objeto_contrato) LIKE '%emergenc%' 
                   OR LOWER(c.objeto_contrato) LIKE '%urgente%' 
                   OR LOWER(c.objeto_contrato) LIKE '%urgênci%'
                 THEN 5 ELSE 0 END
        ) AS score_suspeita
        
    FROM "baliza_dbt"."main_staging"."stg_contratos" c
    LEFT JOIN "baliza_dbt"."main_marts"."dim_orgaos" o 
        ON c.orgao_cnpj = o.orgao_cnpj
    LEFT JOIN (
        -- Supplier frequency analysis
        SELECT 
            fornecedor_ni,
            orgao_cnpj,
            COUNT(*) AS contratos_mesmo_fornecedor
        FROM "baliza_dbt"."main_staging"."stg_contratos"
        WHERE fornecedor_ni IS NOT NULL
        GROUP BY 1, 2
    ) fornecedor_freq 
        ON c.fornecedor_ni = fornecedor_freq.fornecedor_ni 
        AND c.orgao_cnpj = fornecedor_freq.orgao_cnpj
),

contratos_classificados AS (
    SELECT 
        *,
        
        -- Risk classification
        CASE 
            WHEN score_suspeita >= 50 THEN 'Crítico'
            WHEN score_suspeita >= 30 THEN 'Alto'
            WHEN score_suspeita >= 15 THEN 'Médio'
            ELSE 'Baixo'
        END AS nivel_risco,
        
        -- Ranking within same entity
        ROW_NUMBER() OVER (
            PARTITION BY orgao_cnpj 
            ORDER BY score_suspeita DESC, valor_global_brl DESC
        ) AS rank_suspeita_orgao
        
    FROM contratos_scored
)

SELECT * FROM contratos_classificados
WHERE score_suspeita > 0  -- Only include contracts with some suspicion
ORDER BY score_suspeita DESC, valor_global_brl DESC
    );
  
  
[0m15:59:57.249647 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m15:59:57.253071 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.contratos_suspeitos"
[0m15:59:57.253629 [debug] [Thread-1 (]: On model.baliza.contratos_suspeitos: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "model.baliza.contratos_suspeitos"} */
alter table "baliza_dbt"."main_analytics"."contratos_suspeitos__dbt_tmp" rename to "contratos_suspeitos"
[0m15:59:57.255636 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:57.257771 [debug] [Thread-1 (]: On model.baliza.contratos_suspeitos: COMMIT
[0m15:59:57.258186 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.contratos_suspeitos"
[0m15:59:57.258518 [debug] [Thread-1 (]: On model.baliza.contratos_suspeitos: COMMIT
[0m15:59:57.264871 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:59:57.266706 [debug] [Thread-1 (]: Using duckdb connection "model.baliza.contratos_suspeitos"
[0m15:59:57.267116 [debug] [Thread-1 (]: On model.baliza.contratos_suspeitos: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "model.baliza.contratos_suspeitos"} */

      drop table if exists "baliza_dbt"."main_analytics"."contratos_suspeitos__dbt_backup" cascade
    
[0m15:59:57.267963 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:57.269014 [debug] [Thread-1 (]: On model.baliza.contratos_suspeitos: Close
[0m15:59:57.271275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acf7b9b0-7b6e-4dea-8053-2f2a36f11249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761ef5f564d0>]}
[0m15:59:57.272192 [info ] [Thread-1 (]: 4 of 4 OK created sql table model main_analytics.contratos_suspeitos ........... [[32mOK[0m in 0.06s]
[0m15:59:57.272744 [debug] [Thread-1 (]: Finished running node model.baliza.contratos_suspeitos
[0m15:59:57.274487 [debug] [MainThread]: Using duckdb connection "master"
[0m15:59:57.274920 [debug] [MainThread]: On master: BEGIN
[0m15:59:57.275277 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:59:57.277055 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:59:57.277399 [debug] [MainThread]: On master: COMMIT
[0m15:59:57.277717 [debug] [MainThread]: Using duckdb connection "master"
[0m15:59:57.277970 [debug] [MainThread]: On master: COMMIT
[0m15:59:57.278647 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:59:57.278998 [debug] [MainThread]: On master: Close
[0m15:59:57.279483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:57.279727 [debug] [MainThread]: Connection 'model.baliza.contratos_suspeitos' was properly closed.
[0m15:59:57.280105 [info ] [MainThread]: 
[0m15:59:57.280451 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m15:59:57.281199 [debug] [MainThread]: Command end result
[0m15:59:57.303969 [debug] [MainThread]: Wrote artifact WritableManifest to /home/frank/workspace/baliza/dbt_baliza/target/manifest.json
[0m15:59:57.306723 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/frank/workspace/baliza/dbt_baliza/target/semantic_manifest.json
[0m15:59:57.312968 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/frank/workspace/baliza/dbt_baliza/target/run_results.json
[0m15:59:57.313438 [info ] [MainThread]: 
[0m15:59:57.313983 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:59:57.314304 [info ] [MainThread]: 
[0m15:59:57.314651 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m15:59:57.315441 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2751886, "process_in_blocks": "40", "process_kernel_time": 0.218397, "process_mem_max_rss": "191440", "process_out_blocks": "2392", "process_user_time": 2.996266}
[0m15:59:57.315830 [debug] [MainThread]: Command `dbt run` succeeded at 15:59:57.315751 after 1.28 seconds
[0m15:59:57.316167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761ef5f99550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761ef9ae2200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x761ef66fcbf0>]}
[0m15:59:57.316507 [debug] [MainThread]: Flushing usage events
[0m15:59:58.188663 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:00:06.698277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d4490cba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d447d57d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d447d579d0>]}


============================== 16:00:06.701036 | 0abf983e-9b88-4059-ab2f-03f8aea29d2c ==============================
[0m16:00:06.701036 [info ] [MainThread]: Running with dbt=1.10.4
[0m16:00:06.701563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/frank/workspace/baliza/dbt_baliza/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir .', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:00:06.863155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0abf983e-9b88-4059-ab2f-03f8aea29d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d448a43820>]}
[0m16:00:06.908298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0abf983e-9b88-4059-ab2f-03f8aea29d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d447fe1370>]}
[0m16:00:06.910026 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m16:00:06.953619 [debug] [MainThread]: checksum: 073cb5a296270136b24f9c040fdebd0642ef9c263903ef463bfe7e190c538da2, vars: {}, profile: , target: , version: 1.10.4
[0m16:00:07.030635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:07.031398 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:07.038692 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.baliza
- snapshots.baliza
[0m16:00:07.067441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0abf983e-9b88-4059-ab2f-03f8aea29d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d447e0f750>]}
[0m16:00:07.131955 [debug] [MainThread]: Wrote artifact WritableManifest to /home/frank/workspace/baliza/dbt_baliza/target/manifest.json
[0m16:00:07.133794 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/frank/workspace/baliza/dbt_baliza/target/semantic_manifest.json
[0m16:00:07.247931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0abf983e-9b88-4059-ab2f-03f8aea29d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d44353e3f0>]}
[0m16:00:07.248395 [info ] [MainThread]: Found 4 models, 14 data tests, 2 sources, 432 macros
[0m16:00:07.248740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0abf983e-9b88-4059-ab2f-03f8aea29d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d443a43070>]}
[0m16:00:07.250516 [info ] [MainThread]: 
[0m16:00:07.251047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:00:07.251411 [info ] [MainThread]: 
[0m16:00:07.251955 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:00:07.255715 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_baliza_dbt_main_staging'
[0m16:00:07.278357 [debug] [ThreadPool]: Using duckdb connection "list_baliza_dbt_main_staging"
[0m16:00:07.278792 [debug] [ThreadPool]: On list_baliza_dbt_main_staging: BEGIN
[0m16:00:07.279143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:07.449075 [debug] [ThreadPool]: SQL status: OK in 0.170 seconds
[0m16:00:07.449597 [debug] [ThreadPool]: Using duckdb connection "list_baliza_dbt_main_staging"
[0m16:00:07.449934 [debug] [ThreadPool]: On list_baliza_dbt_main_staging: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "connection_name": "list_baliza_dbt_main_staging"} */
select
      'baliza_dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_staging'
    and lower(table_catalog) = 'baliza_dbt'
  
[0m16:00:07.459024 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m16:00:07.460300 [debug] [ThreadPool]: On list_baliza_dbt_main_staging: ROLLBACK
[0m16:00:07.461181 [debug] [ThreadPool]: Failed to rollback 'list_baliza_dbt_main_staging'
[0m16:00:07.461485 [debug] [ThreadPool]: On list_baliza_dbt_main_staging: Close
[0m16:00:07.462119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_baliza_dbt_main_staging, now list_baliza_dbt_main_analytics)
[0m16:00:07.463860 [debug] [ThreadPool]: Using duckdb connection "list_baliza_dbt_main_analytics"
[0m16:00:07.464242 [debug] [ThreadPool]: On list_baliza_dbt_main_analytics: BEGIN
[0m16:00:07.464562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:07.466108 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:00:07.466436 [debug] [ThreadPool]: Using duckdb connection "list_baliza_dbt_main_analytics"
[0m16:00:07.466759 [debug] [ThreadPool]: On list_baliza_dbt_main_analytics: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "connection_name": "list_baliza_dbt_main_analytics"} */
select
      'baliza_dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_analytics'
    and lower(table_catalog) = 'baliza_dbt'
  
[0m16:00:07.469774 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:00:07.470958 [debug] [ThreadPool]: On list_baliza_dbt_main_analytics: ROLLBACK
[0m16:00:07.471530 [debug] [ThreadPool]: Failed to rollback 'list_baliza_dbt_main_analytics'
[0m16:00:07.471813 [debug] [ThreadPool]: On list_baliza_dbt_main_analytics: Close
[0m16:00:07.472424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_baliza_dbt_main_analytics, now list_baliza_dbt_main_marts)
[0m16:00:07.473977 [debug] [ThreadPool]: Using duckdb connection "list_baliza_dbt_main_marts"
[0m16:00:07.474292 [debug] [ThreadPool]: On list_baliza_dbt_main_marts: BEGIN
[0m16:00:07.474537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:07.475933 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:00:07.476233 [debug] [ThreadPool]: Using duckdb connection "list_baliza_dbt_main_marts"
[0m16:00:07.476490 [debug] [ThreadPool]: On list_baliza_dbt_main_marts: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "connection_name": "list_baliza_dbt_main_marts"} */
select
      'baliza_dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_marts'
    and lower(table_catalog) = 'baliza_dbt'
  
[0m16:00:07.479694 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:00:07.480996 [debug] [ThreadPool]: On list_baliza_dbt_main_marts: ROLLBACK
[0m16:00:07.481603 [debug] [ThreadPool]: Failed to rollback 'list_baliza_dbt_main_marts'
[0m16:00:07.481900 [debug] [ThreadPool]: On list_baliza_dbt_main_marts: Close
[0m16:00:07.483315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0abf983e-9b88-4059-ab2f-03f8aea29d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d4439bdf30>]}
[0m16:00:07.483917 [debug] [MainThread]: Using duckdb connection "master"
[0m16:00:07.484227 [debug] [MainThread]: On master: BEGIN
[0m16:00:07.484488 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:00:07.485997 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:00:07.486341 [debug] [MainThread]: On master: COMMIT
[0m16:00:07.486657 [debug] [MainThread]: Using duckdb connection "master"
[0m16:00:07.487007 [debug] [MainThread]: On master: COMMIT
[0m16:00:07.487605 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:00:07.487917 [debug] [MainThread]: On master: Close
[0m16:00:07.490273 [debug] [Thread-1 (]: Began running node test.baliza.dbt_utils_accepted_range_stg_contratos_valor_global_brl__0.81c95d512f
[0m16:00:07.490739 [info ] [Thread-1 (]: 1 of 14 START test dbt_utils_accepted_range_stg_contratos_valor_global_brl__0 .. [RUN]
[0m16:00:07.491243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_baliza_dbt_main_marts, now test.baliza.dbt_utils_accepted_range_stg_contratos_valor_global_brl__0.81c95d512f)
[0m16:00:07.491579 [debug] [Thread-1 (]: Began compiling node test.baliza.dbt_utils_accepted_range_stg_contratos_valor_global_brl__0.81c95d512f
[0m16:00:07.506674 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_accepted_range_stg_contratos_valor_global_brl__0 (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:00:07.507381 [error] [Thread-1 (]: 1 of 14 ERROR dbt_utils_accepted_range_stg_contratos_valor_global_brl__0 ....... [[31mERROR[0m in 0.02s]
[0m16:00:07.507868 [debug] [Thread-1 (]: Finished running node test.baliza.dbt_utils_accepted_range_stg_contratos_valor_global_brl__0.81c95d512f
[0m16:00:07.508248 [debug] [Thread-1 (]: Began running node test.baliza.dbt_utils_source_accepted_range_psa_contratos_raw_valorGlobal__1000000000__0.48080962d7
[0m16:00:07.508582 [info ] [Thread-1 (]: 2 of 14 START test dbt_utils_source_accepted_range_psa_contratos_raw_valorGlobal__1000000000__0  [RUN]
[0m16:00:07.509107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.baliza.dbt_utils_accepted_range_stg_contratos_valor_global_brl__0.81c95d512f, now test.baliza.dbt_utils_source_accepted_range_psa_contratos_raw_valorGlobal__1000000000__0.48080962d7)
[0m16:00:07.509511 [debug] [Thread-1 (]: Began compiling node test.baliza.dbt_utils_source_accepted_range_psa_contratos_raw_valorGlobal__1000000000__0.48080962d7
[0m16:00:07.515239 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_source_accepted_range_psa_contratos_raw_valorGlobal__1000000000__0 (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:00:07.516105 [debug] [Thread-4 (]: Marking all children of 'test.baliza.dbt_utils_accepted_range_stg_contratos_valor_global_brl__0.81c95d512f' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_accepted_range_stg_contratos_valor_global_brl__0 (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m16:00:07.517039 [error] [Thread-1 (]: 2 of 14 ERROR dbt_utils_source_accepted_range_psa_contratos_raw_valorGlobal__1000000000__0  [[31mERROR[0m in 0.01s]
[0m16:00:07.518964 [debug] [Thread-1 (]: Finished running node test.baliza.dbt_utils_source_accepted_range_psa_contratos_raw_valorGlobal__1000000000__0.48080962d7
[0m16:00:07.519790 [debug] [Thread-1 (]: Began running node test.baliza.not_null_stg_contratos_contrato_id.2a97e60918
[0m16:00:07.520443 [debug] [Thread-4 (]: Marking all children of 'test.baliza.dbt_utils_source_accepted_range_psa_contratos_raw_valorGlobal__1000000000__0.48080962d7' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_source_accepted_range_psa_contratos_raw_valorGlobal__1000000000__0 (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m16:00:07.522046 [info ] [Thread-1 (]: 3 of 14 START test not_null_stg_contratos_contrato_id .......................... [RUN]
[0m16:00:07.523403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.baliza.dbt_utils_source_accepted_range_psa_contratos_raw_valorGlobal__1000000000__0.48080962d7, now test.baliza.not_null_stg_contratos_contrato_id.2a97e60918)
[0m16:00:07.524058 [debug] [Thread-1 (]: Began compiling node test.baliza.not_null_stg_contratos_contrato_id.2a97e60918
[0m16:00:07.531380 [debug] [Thread-1 (]: Writing injected SQL for node "test.baliza.not_null_stg_contratos_contrato_id.2a97e60918"
[0m16:00:07.532342 [debug] [Thread-1 (]: Began executing node test.baliza.not_null_stg_contratos_contrato_id.2a97e60918
[0m16:00:07.546773 [debug] [Thread-1 (]: Writing runtime sql for node "test.baliza.not_null_stg_contratos_contrato_id.2a97e60918"
[0m16:00:07.547944 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.not_null_stg_contratos_contrato_id.2a97e60918"
[0m16:00:07.548340 [debug] [Thread-1 (]: On test.baliza.not_null_stg_contratos_contrato_id.2a97e60918: BEGIN
[0m16:00:07.548622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:07.551106 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:00:07.551833 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.not_null_stg_contratos_contrato_id.2a97e60918"
[0m16:00:07.552524 [debug] [Thread-1 (]: On test.baliza.not_null_stg_contratos_contrato_id.2a97e60918: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "test.baliza.not_null_stg_contratos_contrato_id.2a97e60918"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select contrato_id
from "baliza_dbt"."main_staging"."stg_contratos"
where contrato_id is null



  
  
      
    ) dbt_internal_test
[0m16:00:07.554597 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:00:07.558294 [debug] [Thread-1 (]: On test.baliza.not_null_stg_contratos_contrato_id.2a97e60918: ROLLBACK
[0m16:00:07.559154 [debug] [Thread-1 (]: Failed to rollback 'test.baliza.not_null_stg_contratos_contrato_id.2a97e60918'
[0m16:00:07.559983 [debug] [Thread-1 (]: On test.baliza.not_null_stg_contratos_contrato_id.2a97e60918: Close
[0m16:00:07.561236 [info ] [Thread-1 (]: 3 of 14 PASS not_null_stg_contratos_contrato_id ................................ [[32mPASS[0m in 0.04s]
[0m16:00:07.562104 [debug] [Thread-1 (]: Finished running node test.baliza.not_null_stg_contratos_contrato_id.2a97e60918
[0m16:00:07.562760 [debug] [Thread-1 (]: Began running node test.baliza.not_null_stg_contratos_data_assinatura.95423cf866
[0m16:00:07.564015 [info ] [Thread-1 (]: 4 of 14 START test not_null_stg_contratos_data_assinatura ...................... [RUN]
[0m16:00:07.564968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.baliza.not_null_stg_contratos_contrato_id.2a97e60918, now test.baliza.not_null_stg_contratos_data_assinatura.95423cf866)
[0m16:00:07.565594 [debug] [Thread-1 (]: Began compiling node test.baliza.not_null_stg_contratos_data_assinatura.95423cf866
[0m16:00:07.574248 [debug] [Thread-1 (]: Writing injected SQL for node "test.baliza.not_null_stg_contratos_data_assinatura.95423cf866"
[0m16:00:07.575619 [debug] [Thread-1 (]: Began executing node test.baliza.not_null_stg_contratos_data_assinatura.95423cf866
[0m16:00:07.578627 [debug] [Thread-1 (]: Writing runtime sql for node "test.baliza.not_null_stg_contratos_data_assinatura.95423cf866"
[0m16:00:07.579847 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.not_null_stg_contratos_data_assinatura.95423cf866"
[0m16:00:07.580425 [debug] [Thread-1 (]: On test.baliza.not_null_stg_contratos_data_assinatura.95423cf866: BEGIN
[0m16:00:07.580899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:07.582898 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:00:07.583609 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.not_null_stg_contratos_data_assinatura.95423cf866"
[0m16:00:07.584139 [debug] [Thread-1 (]: On test.baliza.not_null_stg_contratos_data_assinatura.95423cf866: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "test.baliza.not_null_stg_contratos_data_assinatura.95423cf866"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select data_assinatura
from "baliza_dbt"."main_staging"."stg_contratos"
where data_assinatura is null



  
  
      
    ) dbt_internal_test
[0m16:00:07.588441 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:00:07.591797 [debug] [Thread-1 (]: On test.baliza.not_null_stg_contratos_data_assinatura.95423cf866: ROLLBACK
[0m16:00:07.592884 [debug] [Thread-1 (]: Failed to rollback 'test.baliza.not_null_stg_contratos_data_assinatura.95423cf866'
[0m16:00:07.593429 [debug] [Thread-1 (]: On test.baliza.not_null_stg_contratos_data_assinatura.95423cf866: Close
[0m16:00:07.594453 [info ] [Thread-1 (]: 4 of 14 PASS not_null_stg_contratos_data_assinatura ............................ [[32mPASS[0m in 0.03s]
[0m16:00:07.595246 [debug] [Thread-1 (]: Finished running node test.baliza.not_null_stg_contratos_data_assinatura.95423cf866
[0m16:00:07.595782 [debug] [Thread-1 (]: Began running node test.baliza.not_null_stg_contratos_orgao_cnpj.2889f34ab2
[0m16:00:07.596410 [info ] [Thread-1 (]: 5 of 14 START test not_null_stg_contratos_orgao_cnpj ........................... [RUN]
[0m16:00:07.597053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.baliza.not_null_stg_contratos_data_assinatura.95423cf866, now test.baliza.not_null_stg_contratos_orgao_cnpj.2889f34ab2)
[0m16:00:07.597573 [debug] [Thread-1 (]: Began compiling node test.baliza.not_null_stg_contratos_orgao_cnpj.2889f34ab2
[0m16:00:07.602901 [debug] [Thread-1 (]: Writing injected SQL for node "test.baliza.not_null_stg_contratos_orgao_cnpj.2889f34ab2"
[0m16:00:07.603923 [debug] [Thread-1 (]: Began executing node test.baliza.not_null_stg_contratos_orgao_cnpj.2889f34ab2
[0m16:00:07.607380 [debug] [Thread-1 (]: Writing runtime sql for node "test.baliza.not_null_stg_contratos_orgao_cnpj.2889f34ab2"
[0m16:00:07.608516 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.not_null_stg_contratos_orgao_cnpj.2889f34ab2"
[0m16:00:07.609085 [debug] [Thread-1 (]: On test.baliza.not_null_stg_contratos_orgao_cnpj.2889f34ab2: BEGIN
[0m16:00:07.609498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:07.611396 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:00:07.612012 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.not_null_stg_contratos_orgao_cnpj.2889f34ab2"
[0m16:00:07.612480 [debug] [Thread-1 (]: On test.baliza.not_null_stg_contratos_orgao_cnpj.2889f34ab2: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "test.baliza.not_null_stg_contratos_orgao_cnpj.2889f34ab2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select orgao_cnpj
from "baliza_dbt"."main_staging"."stg_contratos"
where orgao_cnpj is null



  
  
      
    ) dbt_internal_test
[0m16:00:07.615770 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:00:07.619794 [debug] [Thread-1 (]: On test.baliza.not_null_stg_contratos_orgao_cnpj.2889f34ab2: ROLLBACK
[0m16:00:07.621041 [debug] [Thread-1 (]: Failed to rollback 'test.baliza.not_null_stg_contratos_orgao_cnpj.2889f34ab2'
[0m16:00:07.621793 [debug] [Thread-1 (]: On test.baliza.not_null_stg_contratos_orgao_cnpj.2889f34ab2: Close
[0m16:00:07.623194 [info ] [Thread-1 (]: 5 of 14 PASS not_null_stg_contratos_orgao_cnpj ................................. [[32mPASS[0m in 0.03s]
[0m16:00:07.624153 [debug] [Thread-1 (]: Finished running node test.baliza.not_null_stg_contratos_orgao_cnpj.2889f34ab2
[0m16:00:07.624754 [debug] [Thread-1 (]: Began running node test.baliza.not_null_stg_contratos_valor_global_brl.054d8b3ad9
[0m16:00:07.625362 [info ] [Thread-1 (]: 6 of 14 START test not_null_stg_contratos_valor_global_brl ..................... [RUN]
[0m16:00:07.626055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.baliza.not_null_stg_contratos_orgao_cnpj.2889f34ab2, now test.baliza.not_null_stg_contratos_valor_global_brl.054d8b3ad9)
[0m16:00:07.626566 [debug] [Thread-1 (]: Began compiling node test.baliza.not_null_stg_contratos_valor_global_brl.054d8b3ad9
[0m16:00:07.631733 [debug] [Thread-1 (]: Writing injected SQL for node "test.baliza.not_null_stg_contratos_valor_global_brl.054d8b3ad9"
[0m16:00:07.633012 [debug] [Thread-1 (]: Began executing node test.baliza.not_null_stg_contratos_valor_global_brl.054d8b3ad9
[0m16:00:07.641738 [debug] [Thread-1 (]: Writing runtime sql for node "test.baliza.not_null_stg_contratos_valor_global_brl.054d8b3ad9"
[0m16:00:07.642735 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.not_null_stg_contratos_valor_global_brl.054d8b3ad9"
[0m16:00:07.643190 [debug] [Thread-1 (]: On test.baliza.not_null_stg_contratos_valor_global_brl.054d8b3ad9: BEGIN
[0m16:00:07.643493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:07.645152 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:00:07.645670 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.not_null_stg_contratos_valor_global_brl.054d8b3ad9"
[0m16:00:07.646050 [debug] [Thread-1 (]: On test.baliza.not_null_stg_contratos_valor_global_brl.054d8b3ad9: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "test.baliza.not_null_stg_contratos_valor_global_brl.054d8b3ad9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valor_global_brl
from "baliza_dbt"."main_staging"."stg_contratos"
where valor_global_brl is null



  
  
      
    ) dbt_internal_test
[0m16:00:07.648521 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:00:07.650868 [debug] [Thread-1 (]: On test.baliza.not_null_stg_contratos_valor_global_brl.054d8b3ad9: ROLLBACK
[0m16:00:07.652113 [debug] [Thread-1 (]: Failed to rollback 'test.baliza.not_null_stg_contratos_valor_global_brl.054d8b3ad9'
[0m16:00:07.653213 [debug] [Thread-1 (]: On test.baliza.not_null_stg_contratos_valor_global_brl.054d8b3ad9: Close
[0m16:00:07.655606 [info ] [Thread-1 (]: 6 of 14 PASS not_null_stg_contratos_valor_global_brl ........................... [[32mPASS[0m in 0.03s]
[0m16:00:07.656600 [debug] [Thread-1 (]: Finished running node test.baliza.not_null_stg_contratos_valor_global_brl.054d8b3ad9
[0m16:00:07.657265 [debug] [Thread-1 (]: Began running node test.baliza.source_not_null_control_runs_run_id.8e489e8965
[0m16:00:07.657885 [info ] [Thread-1 (]: 7 of 14 START test source_not_null_control_runs_run_id ......................... [RUN]
[0m16:00:07.658424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.baliza.not_null_stg_contratos_valor_global_brl.054d8b3ad9, now test.baliza.source_not_null_control_runs_run_id.8e489e8965)
[0m16:00:07.658779 [debug] [Thread-1 (]: Began compiling node test.baliza.source_not_null_control_runs_run_id.8e489e8965
[0m16:00:07.662091 [debug] [Thread-1 (]: Writing injected SQL for node "test.baliza.source_not_null_control_runs_run_id.8e489e8965"
[0m16:00:07.662686 [debug] [Thread-1 (]: Began executing node test.baliza.source_not_null_control_runs_run_id.8e489e8965
[0m16:00:07.664420 [debug] [Thread-1 (]: Writing runtime sql for node "test.baliza.source_not_null_control_runs_run_id.8e489e8965"
[0m16:00:07.665096 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.source_not_null_control_runs_run_id.8e489e8965"
[0m16:00:07.665412 [debug] [Thread-1 (]: On test.baliza.source_not_null_control_runs_run_id.8e489e8965: BEGIN
[0m16:00:07.665700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:07.667606 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:00:07.668298 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.source_not_null_control_runs_run_id.8e489e8965"
[0m16:00:07.668690 [debug] [Thread-1 (]: On test.baliza.source_not_null_control_runs_run_id.8e489e8965: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "test.baliza.source_not_null_control_runs_run_id.8e489e8965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select run_id
from "baliza_dbt"."control"."runs"
where run_id is null



  
  
      
    ) dbt_internal_test
[0m16:00:07.670123 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "test.baliza.source_not_null_control_runs_run_id.8e489e8965"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select run_id
from "baliza_dbt"."control"."runs"
where run_id is null



  
  
      
    ) dbt_internal_test
[0m16:00:07.670583 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:00:07.671127 [debug] [Thread-1 (]: On test.baliza.source_not_null_control_runs_run_id.8e489e8965: ROLLBACK
[0m16:00:07.674781 [debug] [Thread-1 (]: Failed to rollback 'test.baliza.source_not_null_control_runs_run_id.8e489e8965'
[0m16:00:07.675212 [debug] [Thread-1 (]: On test.baliza.source_not_null_control_runs_run_id.8e489e8965: Close
[0m16:00:07.677805 [debug] [Thread-1 (]: Runtime Error in test source_not_null_control_runs_run_id (models/staging/schema.yml)
  Catalog Error: Table with name runs does not exist!
  Did you mean "main.duckdb_constraints"?
  
  LINE 17: from "baliza_dbt"."control"."runs"
                ^
[0m16:00:07.678257 [error] [Thread-1 (]: 7 of 14 ERROR source_not_null_control_runs_run_id .............................. [[31mERROR[0m in 0.02s]
[0m16:00:07.678714 [debug] [Thread-1 (]: Finished running node test.baliza.source_not_null_control_runs_run_id.8e489e8965
[0m16:00:07.679193 [debug] [Thread-1 (]: Began running node test.baliza.source_not_null_psa_contratos_raw_baliza_data_date.8c0004763c
[0m16:00:07.679634 [debug] [Thread-4 (]: Marking all children of 'test.baliza.source_not_null_control_runs_run_id.8e489e8965' to be skipped because of status 'error'.  Reason: Runtime Error in test source_not_null_control_runs_run_id (models/staging/schema.yml)
  Catalog Error: Table with name runs does not exist!
  Did you mean "main.duckdb_constraints"?
  
  LINE 17: from "baliza_dbt"."control"."runs"
                ^.
[0m16:00:07.680019 [info ] [Thread-1 (]: 8 of 14 START test source_not_null_psa_contratos_raw_baliza_data_date .......... [RUN]
[0m16:00:07.680613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.baliza.source_not_null_control_runs_run_id.8e489e8965, now test.baliza.source_not_null_psa_contratos_raw_baliza_data_date.8c0004763c)
[0m16:00:07.680929 [debug] [Thread-1 (]: Began compiling node test.baliza.source_not_null_psa_contratos_raw_baliza_data_date.8c0004763c
[0m16:00:07.751423 [debug] [Thread-1 (]: Writing injected SQL for node "test.baliza.source_not_null_psa_contratos_raw_baliza_data_date.8c0004763c"
[0m16:00:07.752285 [debug] [Thread-1 (]: Began executing node test.baliza.source_not_null_psa_contratos_raw_baliza_data_date.8c0004763c
[0m16:00:07.754391 [debug] [Thread-1 (]: Writing runtime sql for node "test.baliza.source_not_null_psa_contratos_raw_baliza_data_date.8c0004763c"
[0m16:00:07.755335 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.source_not_null_psa_contratos_raw_baliza_data_date.8c0004763c"
[0m16:00:07.755771 [debug] [Thread-1 (]: On test.baliza.source_not_null_psa_contratos_raw_baliza_data_date.8c0004763c: BEGIN
[0m16:00:07.756089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:07.758105 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:00:07.758514 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.source_not_null_psa_contratos_raw_baliza_data_date.8c0004763c"
[0m16:00:07.758816 [debug] [Thread-1 (]: On test.baliza.source_not_null_psa_contratos_raw_baliza_data_date.8c0004763c: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "test.baliza.source_not_null_psa_contratos_raw_baliza_data_date.8c0004763c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select baliza_data_date
from "baliza_dbt"."psa"."contratos_raw"
where baliza_data_date is null



  
  
      
    ) dbt_internal_test
[0m16:00:07.759949 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:00:07.761153 [debug] [Thread-1 (]: On test.baliza.source_not_null_psa_contratos_raw_baliza_data_date.8c0004763c: ROLLBACK
[0m16:00:07.761722 [debug] [Thread-1 (]: Failed to rollback 'test.baliza.source_not_null_psa_contratos_raw_baliza_data_date.8c0004763c'
[0m16:00:07.762021 [debug] [Thread-1 (]: On test.baliza.source_not_null_psa_contratos_raw_baliza_data_date.8c0004763c: Close
[0m16:00:07.762613 [info ] [Thread-1 (]: 8 of 14 PASS source_not_null_psa_contratos_raw_baliza_data_date ................ [[32mPASS[0m in 0.08s]
[0m16:00:07.763140 [debug] [Thread-1 (]: Finished running node test.baliza.source_not_null_psa_contratos_raw_baliza_data_date.8c0004763c
[0m16:00:07.763480 [debug] [Thread-1 (]: Began running node test.baliza.source_not_null_psa_contratos_raw_baliza_run_id.d947ee3481
[0m16:00:07.764005 [info ] [Thread-1 (]: 9 of 14 START test source_not_null_psa_contratos_raw_baliza_run_id ............. [RUN]
[0m16:00:07.764541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.baliza.source_not_null_psa_contratos_raw_baliza_data_date.8c0004763c, now test.baliza.source_not_null_psa_contratos_raw_baliza_run_id.d947ee3481)
[0m16:00:07.764873 [debug] [Thread-1 (]: Began compiling node test.baliza.source_not_null_psa_contratos_raw_baliza_run_id.d947ee3481
[0m16:00:07.769045 [debug] [Thread-1 (]: Writing injected SQL for node "test.baliza.source_not_null_psa_contratos_raw_baliza_run_id.d947ee3481"
[0m16:00:07.769928 [debug] [Thread-1 (]: Began executing node test.baliza.source_not_null_psa_contratos_raw_baliza_run_id.d947ee3481
[0m16:00:07.771693 [debug] [Thread-1 (]: Writing runtime sql for node "test.baliza.source_not_null_psa_contratos_raw_baliza_run_id.d947ee3481"
[0m16:00:07.772287 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.source_not_null_psa_contratos_raw_baliza_run_id.d947ee3481"
[0m16:00:07.772606 [debug] [Thread-1 (]: On test.baliza.source_not_null_psa_contratos_raw_baliza_run_id.d947ee3481: BEGIN
[0m16:00:07.772884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:07.774533 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:00:07.774904 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.source_not_null_psa_contratos_raw_baliza_run_id.d947ee3481"
[0m16:00:07.775225 [debug] [Thread-1 (]: On test.baliza.source_not_null_psa_contratos_raw_baliza_run_id.d947ee3481: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "test.baliza.source_not_null_psa_contratos_raw_baliza_run_id.d947ee3481"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select baliza_run_id
from "baliza_dbt"."psa"."contratos_raw"
where baliza_run_id is null



  
  
      
    ) dbt_internal_test
[0m16:00:07.776353 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:00:07.777537 [debug] [Thread-1 (]: On test.baliza.source_not_null_psa_contratos_raw_baliza_run_id.d947ee3481: ROLLBACK
[0m16:00:07.778101 [debug] [Thread-1 (]: Failed to rollback 'test.baliza.source_not_null_psa_contratos_raw_baliza_run_id.d947ee3481'
[0m16:00:07.778390 [debug] [Thread-1 (]: On test.baliza.source_not_null_psa_contratos_raw_baliza_run_id.d947ee3481: Close
[0m16:00:07.779014 [info ] [Thread-1 (]: 9 of 14 PASS source_not_null_psa_contratos_raw_baliza_run_id ................... [[32mPASS[0m in 0.01s]
[0m16:00:07.779499 [debug] [Thread-1 (]: Finished running node test.baliza.source_not_null_psa_contratos_raw_baliza_run_id.d947ee3481
[0m16:00:07.779842 [debug] [Thread-1 (]: Began running node test.baliza.source_not_null_psa_contratos_raw_numeroControlePncpCompra.1c6c06d051
[0m16:00:07.780180 [info ] [Thread-1 (]: 10 of 14 START test source_not_null_psa_contratos_raw_numeroControlePncpCompra . [RUN]
[0m16:00:07.780648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.baliza.source_not_null_psa_contratos_raw_baliza_run_id.d947ee3481, now test.baliza.source_not_null_psa_contratos_raw_numeroControlePncpCompra.1c6c06d051)
[0m16:00:07.780982 [debug] [Thread-1 (]: Began compiling node test.baliza.source_not_null_psa_contratos_raw_numeroControlePncpCompra.1c6c06d051
[0m16:00:07.784071 [debug] [Thread-1 (]: Writing injected SQL for node "test.baliza.source_not_null_psa_contratos_raw_numeroControlePncpCompra.1c6c06d051"
[0m16:00:07.785121 [debug] [Thread-1 (]: Began executing node test.baliza.source_not_null_psa_contratos_raw_numeroControlePncpCompra.1c6c06d051
[0m16:00:07.787882 [debug] [Thread-1 (]: Writing runtime sql for node "test.baliza.source_not_null_psa_contratos_raw_numeroControlePncpCompra.1c6c06d051"
[0m16:00:07.788629 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.source_not_null_psa_contratos_raw_numeroControlePncpCompra.1c6c06d051"
[0m16:00:07.788993 [debug] [Thread-1 (]: On test.baliza.source_not_null_psa_contratos_raw_numeroControlePncpCompra.1c6c06d051: BEGIN
[0m16:00:07.789276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:07.790885 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:00:07.791224 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.source_not_null_psa_contratos_raw_numeroControlePncpCompra.1c6c06d051"
[0m16:00:07.791522 [debug] [Thread-1 (]: On test.baliza.source_not_null_psa_contratos_raw_numeroControlePncpCompra.1c6c06d051: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "test.baliza.source_not_null_psa_contratos_raw_numeroControlePncpCompra.1c6c06d051"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select numeroControlePncpCompra
from "baliza_dbt"."psa"."contratos_raw"
where numeroControlePncpCompra is null



  
  
      
    ) dbt_internal_test
[0m16:00:07.792514 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:00:07.793712 [debug] [Thread-1 (]: On test.baliza.source_not_null_psa_contratos_raw_numeroControlePncpCompra.1c6c06d051: ROLLBACK
[0m16:00:07.794250 [debug] [Thread-1 (]: Failed to rollback 'test.baliza.source_not_null_psa_contratos_raw_numeroControlePncpCompra.1c6c06d051'
[0m16:00:07.794544 [debug] [Thread-1 (]: On test.baliza.source_not_null_psa_contratos_raw_numeroControlePncpCompra.1c6c06d051: Close
[0m16:00:07.795178 [info ] [Thread-1 (]: 10 of 14 PASS source_not_null_psa_contratos_raw_numeroControlePncpCompra ....... [[32mPASS[0m in 0.01s]
[0m16:00:07.795692 [debug] [Thread-1 (]: Finished running node test.baliza.source_not_null_psa_contratos_raw_numeroControlePncpCompra.1c6c06d051
[0m16:00:07.796039 [debug] [Thread-1 (]: Began running node test.baliza.source_not_null_psa_contratos_raw_valorGlobal.6250ae6812
[0m16:00:07.796424 [info ] [Thread-1 (]: 11 of 14 START test source_not_null_psa_contratos_raw_valorGlobal .............. [RUN]
[0m16:00:07.797144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.baliza.source_not_null_psa_contratos_raw_numeroControlePncpCompra.1c6c06d051, now test.baliza.source_not_null_psa_contratos_raw_valorGlobal.6250ae6812)
[0m16:00:07.797479 [debug] [Thread-1 (]: Began compiling node test.baliza.source_not_null_psa_contratos_raw_valorGlobal.6250ae6812
[0m16:00:07.800952 [debug] [Thread-1 (]: Writing injected SQL for node "test.baliza.source_not_null_psa_contratos_raw_valorGlobal.6250ae6812"
[0m16:00:07.801982 [debug] [Thread-1 (]: Began executing node test.baliza.source_not_null_psa_contratos_raw_valorGlobal.6250ae6812
[0m16:00:07.804237 [debug] [Thread-1 (]: Writing runtime sql for node "test.baliza.source_not_null_psa_contratos_raw_valorGlobal.6250ae6812"
[0m16:00:07.804950 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.source_not_null_psa_contratos_raw_valorGlobal.6250ae6812"
[0m16:00:07.805327 [debug] [Thread-1 (]: On test.baliza.source_not_null_psa_contratos_raw_valorGlobal.6250ae6812: BEGIN
[0m16:00:07.805607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:07.807310 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:00:07.807759 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.source_not_null_psa_contratos_raw_valorGlobal.6250ae6812"
[0m16:00:07.808169 [debug] [Thread-1 (]: On test.baliza.source_not_null_psa_contratos_raw_valorGlobal.6250ae6812: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "test.baliza.source_not_null_psa_contratos_raw_valorGlobal.6250ae6812"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select valorGlobal
from "baliza_dbt"."psa"."contratos_raw"
where valorGlobal is null



  
  
      
    ) dbt_internal_test
[0m16:00:07.809889 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:00:07.812061 [debug] [Thread-1 (]: On test.baliza.source_not_null_psa_contratos_raw_valorGlobal.6250ae6812: ROLLBACK
[0m16:00:07.812954 [debug] [Thread-1 (]: Failed to rollback 'test.baliza.source_not_null_psa_contratos_raw_valorGlobal.6250ae6812'
[0m16:00:07.813330 [debug] [Thread-1 (]: On test.baliza.source_not_null_psa_contratos_raw_valorGlobal.6250ae6812: Close
[0m16:00:07.814120 [info ] [Thread-1 (]: 11 of 14 PASS source_not_null_psa_contratos_raw_valorGlobal .................... [[32mPASS[0m in 0.02s]
[0m16:00:07.814775 [debug] [Thread-1 (]: Finished running node test.baliza.source_not_null_psa_contratos_raw_valorGlobal.6250ae6812
[0m16:00:07.815452 [debug] [Thread-1 (]: Began running node test.baliza.source_unique_control_runs_run_id.22fa28177a
[0m16:00:07.816331 [info ] [Thread-1 (]: 12 of 14 START test source_unique_control_runs_run_id .......................... [RUN]
[0m16:00:07.817208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.baliza.source_not_null_psa_contratos_raw_valorGlobal.6250ae6812, now test.baliza.source_unique_control_runs_run_id.22fa28177a)
[0m16:00:07.817925 [debug] [Thread-1 (]: Began compiling node test.baliza.source_unique_control_runs_run_id.22fa28177a
[0m16:00:07.826250 [debug] [Thread-1 (]: Writing injected SQL for node "test.baliza.source_unique_control_runs_run_id.22fa28177a"
[0m16:00:07.827129 [debug] [Thread-1 (]: Began executing node test.baliza.source_unique_control_runs_run_id.22fa28177a
[0m16:00:07.829573 [debug] [Thread-1 (]: Writing runtime sql for node "test.baliza.source_unique_control_runs_run_id.22fa28177a"
[0m16:00:07.830665 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.source_unique_control_runs_run_id.22fa28177a"
[0m16:00:07.831296 [debug] [Thread-1 (]: On test.baliza.source_unique_control_runs_run_id.22fa28177a: BEGIN
[0m16:00:07.831696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:07.833634 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:00:07.834329 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.source_unique_control_runs_run_id.22fa28177a"
[0m16:00:07.835029 [debug] [Thread-1 (]: On test.baliza.source_unique_control_runs_run_id.22fa28177a: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "test.baliza.source_unique_control_runs_run_id.22fa28177a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    run_id as unique_field,
    count(*) as n_records

from "baliza_dbt"."control"."runs"
where run_id is not null
group by run_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:00:07.836828 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "test.baliza.source_unique_control_runs_run_id.22fa28177a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    run_id as unique_field,
    count(*) as n_records

from "baliza_dbt"."control"."runs"
where run_id is not null
group by run_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:00:07.837399 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:00:07.838120 [debug] [Thread-1 (]: On test.baliza.source_unique_control_runs_run_id.22fa28177a: ROLLBACK
[0m16:00:07.841723 [debug] [Thread-1 (]: Failed to rollback 'test.baliza.source_unique_control_runs_run_id.22fa28177a'
[0m16:00:07.842215 [debug] [Thread-1 (]: On test.baliza.source_unique_control_runs_run_id.22fa28177a: Close
[0m16:00:07.844900 [debug] [Thread-1 (]: Runtime Error in test source_unique_control_runs_run_id (models/staging/schema.yml)
  Catalog Error: Table with name runs does not exist!
  Did you mean "main.duckdb_constraints"?
  
  LINE 18: from "baliza_dbt"."control"."runs"
                ^
[0m16:00:07.845477 [error] [Thread-1 (]: 12 of 14 ERROR source_unique_control_runs_run_id ............................... [[31mERROR[0m in 0.03s]
[0m16:00:07.846005 [debug] [Thread-1 (]: Finished running node test.baliza.source_unique_control_runs_run_id.22fa28177a
[0m16:00:07.846404 [debug] [Thread-1 (]: Began running node test.baliza.source_unique_psa_contratos_raw_numeroControlePncpCompra.6990945c40
[0m16:00:07.846760 [info ] [Thread-1 (]: 13 of 14 START test source_unique_psa_contratos_raw_numeroControlePncpCompra ... [RUN]
[0m16:00:07.847316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.baliza.source_unique_control_runs_run_id.22fa28177a, now test.baliza.source_unique_psa_contratos_raw_numeroControlePncpCompra.6990945c40)
[0m16:00:07.847637 [debug] [Thread-1 (]: Began compiling node test.baliza.source_unique_psa_contratos_raw_numeroControlePncpCompra.6990945c40
[0m16:00:07.851620 [debug] [Thread-1 (]: Writing injected SQL for node "test.baliza.source_unique_psa_contratos_raw_numeroControlePncpCompra.6990945c40"
[0m16:00:07.852935 [debug] [Thread-4 (]: Marking all children of 'test.baliza.source_unique_control_runs_run_id.22fa28177a' to be skipped because of status 'error'.  Reason: Runtime Error in test source_unique_control_runs_run_id (models/staging/schema.yml)
  Catalog Error: Table with name runs does not exist!
  Did you mean "main.duckdb_constraints"?
  
  LINE 18: from "baliza_dbt"."control"."runs"
                ^.
[0m16:00:07.853656 [debug] [Thread-1 (]: Began executing node test.baliza.source_unique_psa_contratos_raw_numeroControlePncpCompra.6990945c40
[0m16:00:07.856379 [debug] [Thread-1 (]: Writing runtime sql for node "test.baliza.source_unique_psa_contratos_raw_numeroControlePncpCompra.6990945c40"
[0m16:00:07.857116 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.source_unique_psa_contratos_raw_numeroControlePncpCompra.6990945c40"
[0m16:00:07.857452 [debug] [Thread-1 (]: On test.baliza.source_unique_psa_contratos_raw_numeroControlePncpCompra.6990945c40: BEGIN
[0m16:00:07.857739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:07.859310 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:00:07.859648 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.source_unique_psa_contratos_raw_numeroControlePncpCompra.6990945c40"
[0m16:00:07.859931 [debug] [Thread-1 (]: On test.baliza.source_unique_psa_contratos_raw_numeroControlePncpCompra.6990945c40: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "test.baliza.source_unique_psa_contratos_raw_numeroControlePncpCompra.6990945c40"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    numeroControlePncpCompra as unique_field,
    count(*) as n_records

from "baliza_dbt"."psa"."contratos_raw"
where numeroControlePncpCompra is not null
group by numeroControlePncpCompra
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:00:07.861908 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:00:07.863216 [debug] [Thread-1 (]: On test.baliza.source_unique_psa_contratos_raw_numeroControlePncpCompra.6990945c40: ROLLBACK
[0m16:00:07.863787 [debug] [Thread-1 (]: Failed to rollback 'test.baliza.source_unique_psa_contratos_raw_numeroControlePncpCompra.6990945c40'
[0m16:00:07.864089 [debug] [Thread-1 (]: On test.baliza.source_unique_psa_contratos_raw_numeroControlePncpCompra.6990945c40: Close
[0m16:00:07.864742 [error] [Thread-1 (]: 13 of 14 FAIL 1 source_unique_psa_contratos_raw_numeroControlePncpCompra ....... [[31mFAIL 1[0m in 0.02s]
[0m16:00:07.865212 [debug] [Thread-1 (]: Finished running node test.baliza.source_unique_psa_contratos_raw_numeroControlePncpCompra.6990945c40
[0m16:00:07.865573 [debug] [Thread-1 (]: Began running node test.baliza.unique_stg_contratos_contrato_id.e8c52a0f5e
[0m16:00:07.865947 [info ] [Thread-1 (]: 14 of 14 START test unique_stg_contratos_contrato_id ........................... [RUN]
[0m16:00:07.866814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.baliza.source_unique_psa_contratos_raw_numeroControlePncpCompra.6990945c40, now test.baliza.unique_stg_contratos_contrato_id.e8c52a0f5e)
[0m16:00:07.867633 [debug] [Thread-1 (]: Began compiling node test.baliza.unique_stg_contratos_contrato_id.e8c52a0f5e
[0m16:00:07.872222 [debug] [Thread-1 (]: Writing injected SQL for node "test.baliza.unique_stg_contratos_contrato_id.e8c52a0f5e"
[0m16:00:07.873254 [debug] [Thread-1 (]: Began executing node test.baliza.unique_stg_contratos_contrato_id.e8c52a0f5e
[0m16:00:07.875432 [debug] [Thread-1 (]: Writing runtime sql for node "test.baliza.unique_stg_contratos_contrato_id.e8c52a0f5e"
[0m16:00:07.876029 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.unique_stg_contratos_contrato_id.e8c52a0f5e"
[0m16:00:07.876421 [debug] [Thread-1 (]: On test.baliza.unique_stg_contratos_contrato_id.e8c52a0f5e: BEGIN
[0m16:00:07.876738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:00:07.878377 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:00:07.878709 [debug] [Thread-1 (]: Using duckdb connection "test.baliza.unique_stg_contratos_contrato_id.e8c52a0f5e"
[0m16:00:07.879064 [debug] [Thread-1 (]: On test.baliza.unique_stg_contratos_contrato_id.e8c52a0f5e: /* {"app": "dbt", "dbt_version": "1.10.4", "profile_name": "baliza", "target_name": "dev", "node_id": "test.baliza.unique_stg_contratos_contrato_id.e8c52a0f5e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    contrato_id as unique_field,
    count(*) as n_records

from "baliza_dbt"."main_staging"."stg_contratos"
where contrato_id is not null
group by contrato_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:00:07.881697 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:00:07.883139 [debug] [Thread-1 (]: On test.baliza.unique_stg_contratos_contrato_id.e8c52a0f5e: ROLLBACK
[0m16:00:07.883939 [debug] [Thread-1 (]: Failed to rollback 'test.baliza.unique_stg_contratos_contrato_id.e8c52a0f5e'
[0m16:00:07.884343 [debug] [Thread-1 (]: On test.baliza.unique_stg_contratos_contrato_id.e8c52a0f5e: Close
[0m16:00:07.885404 [error] [Thread-1 (]: 14 of 14 FAIL 1 unique_stg_contratos_contrato_id ............................... [[31mFAIL 1[0m in 0.02s]
[0m16:00:07.886238 [debug] [Thread-1 (]: Finished running node test.baliza.unique_stg_contratos_contrato_id.e8c52a0f5e
[0m16:00:07.888479 [debug] [MainThread]: Using duckdb connection "master"
[0m16:00:07.888854 [debug] [MainThread]: On master: BEGIN
[0m16:00:07.889124 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:00:07.890760 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m16:00:07.891165 [debug] [MainThread]: On master: COMMIT
[0m16:00:07.891432 [debug] [MainThread]: Using duckdb connection "master"
[0m16:00:07.891671 [debug] [MainThread]: On master: COMMIT
[0m16:00:07.892243 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:00:07.892559 [debug] [MainThread]: On master: Close
[0m16:00:07.893018 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:07.893319 [debug] [MainThread]: Connection 'test.baliza.unique_stg_contratos_contrato_id.e8c52a0f5e' was properly closed.
[0m16:00:07.893629 [info ] [MainThread]: 
[0m16:00:07.893969 [info ] [MainThread]: Finished running 14 data tests in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m16:00:07.895464 [debug] [MainThread]: Command end result
[0m16:00:07.912158 [debug] [MainThread]: Wrote artifact WritableManifest to /home/frank/workspace/baliza/dbt_baliza/target/manifest.json
[0m16:00:07.914079 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/frank/workspace/baliza/dbt_baliza/target/semantic_manifest.json
[0m16:00:07.920325 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/frank/workspace/baliza/dbt_baliza/target/run_results.json
[0m16:00:07.920751 [info ] [MainThread]: 
[0m16:00:07.921093 [info ] [MainThread]: [31mCompleted with 6 errors, 0 partial successes, and 0 warnings:[0m
[0m16:00:07.921370 [info ] [MainThread]: 
[0m16:00:07.921686 [error] [MainThread]: [31mFailure in test dbt_utils_accepted_range_stg_contratos_valor_global_brl__0 (models/staging/schema.yml)[0m
[0m16:00:07.922003 [error] [MainThread]:   Compilation Error in test dbt_utils_accepted_range_stg_contratos_valor_global_brl__0 (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:00:07.922256 [info ] [MainThread]: 
[0m16:00:07.922551 [error] [MainThread]: [31mFailure in test dbt_utils_source_accepted_range_psa_contratos_raw_valorGlobal__1000000000__0 (models/staging/schema.yml)[0m
[0m16:00:07.922848 [error] [MainThread]:   Compilation Error in test dbt_utils_source_accepted_range_psa_contratos_raw_valorGlobal__1000000000__0 (models/staging/schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:00:07.923126 [info ] [MainThread]: 
[0m16:00:07.923398 [error] [MainThread]: [31mFailure in test source_not_null_control_runs_run_id (models/staging/schema.yml)[0m
[0m16:00:07.923663 [error] [MainThread]:   Runtime Error in test source_not_null_control_runs_run_id (models/staging/schema.yml)
  Catalog Error: Table with name runs does not exist!
  Did you mean "main.duckdb_constraints"?
  
  LINE 17: from "baliza_dbt"."control"."runs"
                ^
[0m16:00:07.923912 [info ] [MainThread]: 
[0m16:00:07.924211 [info ] [MainThread]:   compiled code at target/compiled/baliza/models/staging/schema.yml/source_not_null_control_runs_run_id.sql
[0m16:00:07.924502 [info ] [MainThread]: 
[0m16:00:07.924813 [error] [MainThread]: [31mFailure in test source_unique_control_runs_run_id (models/staging/schema.yml)[0m
[0m16:00:07.925102 [error] [MainThread]:   Runtime Error in test source_unique_control_runs_run_id (models/staging/schema.yml)
  Catalog Error: Table with name runs does not exist!
  Did you mean "main.duckdb_constraints"?
  
  LINE 18: from "baliza_dbt"."control"."runs"
                ^
[0m16:00:07.925348 [info ] [MainThread]: 
[0m16:00:07.925649 [info ] [MainThread]:   compiled code at target/compiled/baliza/models/staging/schema.yml/source_unique_control_runs_run_id.sql
[0m16:00:07.925924 [info ] [MainThread]: 
[0m16:00:07.926227 [error] [MainThread]: [31mFailure in test source_unique_psa_contratos_raw_numeroControlePncpCompra (models/staging/schema.yml)[0m
[0m16:00:07.926515 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m16:00:07.926765 [info ] [MainThread]: 
[0m16:00:07.927073 [info ] [MainThread]:   compiled code at target/compiled/baliza/models/staging/schema.yml/source_unique_psa_contratos_raw_numeroControlePncpCompra.sql
[0m16:00:07.927310 [info ] [MainThread]: 
[0m16:00:07.927576 [error] [MainThread]: [31mFailure in test unique_stg_contratos_contrato_id (models/staging/schema.yml)[0m
[0m16:00:07.927871 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m16:00:07.928127 [info ] [MainThread]: 
[0m16:00:07.928449 [info ] [MainThread]:   compiled code at target/compiled/baliza/models/staging/schema.yml/unique_stg_contratos_contrato_id.sql
[0m16:00:07.928726 [info ] [MainThread]: 
[0m16:00:07.929015 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=6 SKIP=0 NO-OP=0 TOTAL=14
[0m16:00:07.929715 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.2687411, "process_in_blocks": "72", "process_kernel_time": 0.251318, "process_mem_max_rss": "186128", "process_out_blocks": "3520", "process_user_time": 2.861165}
[0m16:00:07.930200 [debug] [MainThread]: Command `dbt test` failed at 16:00:07.930115 after 1.27 seconds
[0m16:00:07.930614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d447e40d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d443924b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d443926410>]}
[0m16:00:07.931076 [debug] [MainThread]: Flushing usage events
[0m16:00:08.646269 [debug] [MainThread]: An error was encountered while trying to flush usage events
