version: 2

models:
  - name: stage_contratacoes
    description: "Cleaned and validated PNCP contratacoes data"
    columns:
      - name: numeroControlePNCP
        tests:
          - unique
          - not_null
      - name: anoContratacao
        tests:
          - not_null
      - name: cnpjOrgao
        tests:
          - not_null
      - name: modalidadeId
        tests:
          - not_null
          - test_enum_drift:
              seed_name: 'modalidade_contratacao'
  - name: stage_orgaos_entidades
    description: "Cleaned and validated PNCP orgaos e entidades data"
    columns:
      - name: sequencialOrgao
        tests:
          - unique
          - not_null
      - name: cnpjOrgao
        tests:
          - test_cnpj_format
  - name: stage_contratos
    description: "Cleaned and validated PNCP contratos data"
    columns:
      - name: numeroControlePNCPContrato
        tests:
          - unique
          - not_null
      - name: numeroControlePNCP
        tests:
          - relationships:
              to: ref('stage_contratacoes')
              field: numeroControlePNCP
